<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>TF7_Regression_beta</title>

<script src="site_libs/header-attrs-2.4/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados en movimiento</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sreencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="screencast_t_test.html">t-test Screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Lo básico de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Lo básico de RMarkdown</a>
    </li>
    <li>
      <a href="Tendencias_Centrales.html"> Tendencias Centrales</a>
    </li>
    <li>
      <a href="Medidas_Dispersión.html"> Medidas de Dispersión</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taller para Facultad
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TF_1_Descripción.html">Descripción del taller</a>
    </li>
    <li>
      <a href="TF1_Regresion_Lineal.html">Regresion_Lineal</a>
    </li>
    <li>
      <a href="TF2_Regresion_Cuadratica_otro.html">Regresion no lineal</a>
    </li>
    <li>
      <a href="TF3_Regresion_Multiples.html">Regresion Multiples</a>
    </li>
    <li>
      <a href="TF4_GLM.html">Modelos Lineales Generalizados</a>
    </li>
    <li>
      <a href="TF5_Regresion_logistica.html">Regresion Logística</a>
    </li>
    <li>
      <a href="TF6_Regresion_Poisson.html">Regresion Poisson</a>
    </li>
    <li>
      <a href="TF7_Regresion_beta.html">Regresion Beta</a>
    </li>
    <li>
      <a href="TF8_Akaike_Information_Criterion.html">Criterio de Selección</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datos.html">Los Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">TF7_Regression_beta</h1>

</div>


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #437d66;
}
</style>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>rlt_theme &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb1-4"><a href="#cb1-4"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb1-5"><a href="#cb1-5"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),  </span>
<span id="cb1-6"><a href="#cb1-6"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">15</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))<span class="op">+</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="st">        </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="Graficos/Analitica.png" width="50%" /><img src="Graficos/UPR_IPERT_logo.png" width="50%" /></p>
<hr />
<div id="beta-regression" class="section level2">
<h2>Beta regression</h2>
<p>La regresión beta es una acercamiento GLM. La regresión beta es para modelar variables dependientes distribuidas con la distribución beta. Datos que tienen distribución beta incluye proporciones y razones, donde los valores se encuentra entre 0 y 1. Además de la producir una regresión que máxima la verosimilitud (tanto para la media como para la precisión de una respuesta distribuida en beta), se proporcionan estimaciones con corrección de sesgo.</p>
<p>Los valores de la variable de respuesta deben estar entre 0 y 1, Si por consecuencia tiene valores que son 0 o 1, es necesario cambiarlo a 1= .999 y 0= 0.001. los números no pueden ser 0 ni 1, deben ser mayores que 0 y menores que 1.</p>
<p>La paquete “betareg” y sus datos. Tenga en cuenta que este es el enfoque del modelo GLM con la respuesta a través de una función de enlace y un predictor lineal. Igual como GLM normal, existen numerosas funciones de enlace, que pueden ser util como “logit”, “probit”, “cloglog”, “cauchit”, “log”, “loglog”.</p>
<p>Casi toda la información que se estará presentando aqui proviene de Vribari-Neto y Zeileis (Beta Regression in R).</p>
<p>Consulte el pdf, <a href="https://cran.r-project.org/web/packages/betareg/betareg.pdf" class="uri">https://cran.r-project.org/web/packages/betareg/betareg.pdf</a> para obtener una descripción del paquete y más detalles.</p>
<p>Estaré usando datos diferentes a lo que se presenta en el paquete para demostrar el valor de los analisis.</p>
</div>
<div id="primer-paso-que-es-una-distribución-beta" class="section level1">
<h1>Primer paso, que es una distribución beta?</h1>
<p>Lo más importante de la distribución beta es que los valores NUNCA son menores de 0 ni mayores de 1. En adición los intervalos de confianza tampoco no pueden ser ni menor de 0 ni mayor de 1.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0
## ✓ purrr   0.3.4</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>Aqui una serie de distribuciones beta. La distribución beta se calcula con dos parametros, <strong>shape 1</strong> y <strong>shape 2</strong>. No vamos a entrar en estos parámetros, aunque pueden ir a la pagina de Wikipedia para tener más información. Lo que deberian fijarse es que aparte de cuando hay un shape que es igual como Shape 1 = 0.5, y shape 2 = 0.5, (tambien shape 2 y 2) todas las otras distribuciones no son simétrica. Siempre hay una cola que se extiende en los valores pequeños o grandes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw">ggplot</span>(betadj, <span class="kw">aes</span>(b1, cases, <span class="dt">colour=</span>beta_shapes))<span class="op">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">5</span>)<span class="op">+</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw">scale_colour_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Beta_Shapes&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Shape 2 y 2&quot;</span>, <span class="st">&quot;Shape .5 y .5&quot;</span>, <span class="st">&quot;Shape 2 y 5&quot;</span>, <span class="st">&quot;Shape 8 y 1.5&quot;</span>))</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="propoción-de-fumadores-por-diferentes-paises.-los-datos-provienen-de-world-bank-en-el-siguiente-enlace-smokers.-se-encuentra-información-sobre-187-pais-y-la-proporción-de-población-mayor-de-15-años-que-fuman" class="section level1">
<h1>Propoción de fumadores por diferentes paises. Los datos provienen de World Bank en el siguiente enlace, <a href="https://data.worldbank.org/indicator/SH.PRV.SMOK">Smokers</a>. Se encuentra información sobre 187 pais y la proporción de población mayor de 15 años que fuman</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">library</span>(readr)</span>
<span id="cb8-2"><a href="#cb8-2"></a>Proportion_smokers_world &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/Proportion_smokers_world.csv&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   Country_Name = col_character(),
##   Country_Code = col_character(),
##   Indicator_Name = col_character(),
##   Indicator_Code = col_character(),
##   Y2000 = col_double(),
##   Y2005 = col_double(),
##   Y2010 = col_double(),
##   Y2011 = col_double(),
##   Y2012 = col_double(),
##   Y2013 = col_double(),
##   Y2014 = col_double(),
##   Y2015 = col_double(),
##   Y2016 = col_double()
## )</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>Smokers=Proportion_smokers_world </span></code></pre></div>
<p>Primero vamos a convertir los datos en proporción ya que el programa tiene que utilizar datos mayor de 0 y menor de 1. Seleccionamos el año 2000 y creamos un histograma de la distribución.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>Smokers<span class="op">$</span>Y2000P=(Smokers<span class="op">$</span>Y2000)<span class="op">/</span><span class="dv">100</span> <span class="co"># convertir en proporción</span></span></code></pre></div>
<div id="convertir-el-promedio-y-varianza-en-shape" class="section level2">
<h2>Convertir el promedio y varianza en shape</h2>
<p>Convertir el promedio y la varianza de los datos en los valores del shape <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Se usa la siguiente para calcular los shapes. El <span class="math inline">\(\alpha\)</span> referiere al promedio y <span class="math inline">\(\beta\)</span> a la varianza. Usamos la siguiente función.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>estBetaParams &lt;-<span class="st"> </span><span class="cf">function</span>(mu, var) {</span>
<span id="cb12-2"><a href="#cb12-2"></a>  alpha &lt;-<span class="st"> </span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu) <span class="op">/</span><span class="st"> </span>var <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mu) <span class="op">*</span><span class="st"> </span>mu <span class="op">^</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  beta &lt;-<span class="st"> </span>alpha <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mu <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="kw">return</span>(<span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> alpha, <span class="dt">beta =</span> beta))</span>
<span id="cb12-5"><a href="#cb12-5"></a>}</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#mean(Smokers$Y2000P)</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#var(Smokers$Y2000P)</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">estBetaParams</span>((<span class="kw">mean</span>(Smokers<span class="op">$</span>Y2000P)), (<span class="kw">var</span>(Smokers<span class="op">$</span>Y2000P)))</span></code></pre></div>
<pre><code>## $alpha
## [1] 3.592488
## 
## $beta
## [1] 9.181559</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>Smokers<span class="op">$</span>Y2000P=(Smokers<span class="op">$</span>Y2000)<span class="op">/</span><span class="dv">100</span> <span class="co"># convertir en proporción</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">len =</span> <span class="dv">100</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw">mean</span>(Smokers<span class="op">$</span>Y2000P)</span></code></pre></div>
<pre><code>## [1] 0.2812334</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">var</span>(Smokers<span class="op">$</span>Y2000P)</span></code></pre></div>
<pre><code>## [1] 0.01467551</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">ggplot</span>(Smokers, <span class="kw">aes</span>(Y2000P))<span class="op">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="op">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Smokers<span class="op">$</span>Y2000P, <span class="dt">y =</span> ..y..), <span class="dt">fun =</span> dbeta, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>                      <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="fl">3.593</span>, <span class="dt">shape2 =</span> <span class="fl">9.185</span>))<span class="op">+</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb18-6"><a href="#cb18-6"></a>                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Smokers<span class="op">$</span>Y2000P, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb18-7"><a href="#cb18-7"></a>                <span class="dt">sd =</span> <span class="kw">sd</span>(Smokers<span class="op">$</span>Y2000P, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)), </span>
<span id="cb18-8"><a href="#cb18-8"></a>                <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Proportción de fumadores por Pais&quot;</span>)<span class="op">+</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">4.2</span>, <span class="dt">label =</span> <span class="st">&quot;Verde: dist Normal&quot;</span>, <span class="dt">color=</span><span class="st">&quot;darkgreen&quot;</span>)<span class="op">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">3.7</span>, <span class="dt">label =</span> <span class="st">&quot;Verde: dist Beta&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Calculando el intervalo de confianza del promedio de una distribución beta. Se necesita los siguientes paquetes <strong>simpleboot , boot</strong>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">library</span>(simpleboot)</span></code></pre></div>
<pre><code>## Simple Bootstrap Routines (1.1-7)</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">library</span>(boot) <span class="co"># paquete para calcular el intervalo de confianza de una distribución beta</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>n=<span class="dv">187</span> <span class="co"># El tamaño de muestra de los datos</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>alpha =<span class="st"> </span><span class="fl">3.593</span> <span class="co"># estimado de la función arriba </span></span>
<span id="cb22-4"><a href="#cb22-4"></a>beta =<span class="st"> </span><span class="fl">9.185</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>x =<span class="st"> </span><span class="kw">rbeta</span>(n, alpha, beta)</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a>x.boot =<span class="st"> </span><span class="kw">one.boot</span>(x, median, <span class="dt">R=</span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span>) <span class="co"># Aquí se usa la mediana, pq el promedio *mean* sera sesgado a la derecha.  </span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="kw">boot.ci</span>(x.boot, <span class="dt">type=</span><span class="st">&quot;bca&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = x.boot, type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   ( 0.2393,  0.2832 )  
## Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
<div id="sobreponemos-el-intervalo-de-confianza-de-la-mediana-sobre-la-distribución-beta" class="section level1">
<h1>Sobreponemos el intervalo de confianza de la mediana sobre la distribución beta</h1>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">ggplot</span>(Smokers, <span class="kw">aes</span>(Y2000P))<span class="op">+</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">bins=</span><span class="dv">20</span>, <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="op">+</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Smokers<span class="op">$</span>Y2000P, <span class="dt">y =</span> ..y..), <span class="dt">fun =</span> dbeta, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">n =</span> <span class="dv">100</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>                      <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="fl">3.593</span>, <span class="dt">shape2 =</span> <span class="fl">9.185</span>))<span class="op">+</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span><span class="fl">0.2320</span>, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co"># El intervalo de confianza del promedio</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span><span class="fl">0.2768</span>, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="st">  </span>rlt_theme<span class="op">+</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Proporción de fumadores por Pais&quot;</span>)</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Ahora vamos es hacer el primer análisis de regresión donde nuestra respuesta es una proporción.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">library</span>(ggversa) <span class="co"># paquete para los datos</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">attach</span>(dipodium)</span>
<span id="cb25-3"><a href="#cb25-3"></a>dipodium</span></code></pre></div>
<pre><code>## # A tibble: 1,363 x 21
##    `Tree Number` `Tree species`   DBH `Plant number` `Ramet number` Distance
##            &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;          &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;
##  1             1 E.o             75                1              1     2.47
##  2             1 E.o             76                2              1     1.97
##  3             2 E.o             76                3              1     1.95
##  4             3 E.o             58                4              1     3.24
##  5             4 E.o             NA                5              1     0.85
##  6             5 E.o             59                6              1     2.62
##  7             5 E.o             59                7              1     2.82
##  8             6 E.o              8                8              1     3.12
##  9             7 E.o             11.5              9              1     1.12
## 10             8 E.o              8.5             10              1     0.75
## # … with 1,353 more rows, and 15 more variables: Orientation &lt;dbl&gt;,
## #   Number_of_Flowers &lt;int&gt;, Height_Inflo &lt;int&gt;, Herbivory &lt;chr&gt;,
## #   RowPosition_NF &lt;int&gt;, Number_Flowers_position &lt;int&gt;,
## #   Number_of_fruits &lt;int&gt;, Perc_FR_set &lt;dbl&gt;, pardalinum_or_roseum &lt;chr&gt;,
## #   Fruit_position_effect &lt;int&gt;, Frutos_si_o_no &lt;int&gt;,
## #   P_or_R_Infl_Lenght &lt;chr&gt;, `Num of fruits` &lt;int&gt;, Species_Name &lt;chr&gt;,
## #   `Cardinal orientation` &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">library</span>(betareg) <span class="co"># El paquete para hacer regresión beta</span></span></code></pre></div>
<hr />
<div id="regresión-beta" class="section level2">
<h2>Regresión beta</h2>
<div class="figure">
<img src="Graficos/dipodium_roseum.jpg" alt="from this webpage: https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/" width="300" style="float:right; padding:10px" />
<p class="caption">
from this webpage: <a href="https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/" class="uri">https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/</a>
</p>
</div>
<p>Los datos provienen de una especie de orquidea de Autralia, <em>Dipodium roseum</em>, recolectado por RLT en 2004-2005. Vamos a evaluar la relación entre el número de flores y la proporción de frutos por planta. El primer paso es asegarar que no haya valores de 0 y 1. En este caso no hay ni una planta que tiene 100% de frutos, pero si hay individuos que tienen cero frutos.</p>
<ul>
<li><p>RECUERDA x &gt;0 y &lt;1. NO se acepta 0 o 1. Entonces a los valores de 0 se le puede añadir un valor mínimo como 0.001 y a los 1 restar 0.001. En realidad esta modificación no impacta la interpretación de los resultados.</p></li>
<li><p>se remueva también del archivo los NA.</p></li>
<li><p>Nota que el modelo se construye como un modelo lineal <strong>betareg(y~x, data =na.omit(df))</strong>. Las variables del archivo son <strong>PropFR</strong>, el proporción de frutos (número de frutos/números de flores) por cada individuo y el número de flores, <strong>Number_of_Flowers</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">head</span>(dipodium)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 21
##   `Tree Number` `Tree species`   DBH `Plant number` `Ramet number` Distance
##           &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;          &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;
## 1             1 E.o               75              1              1     2.47
## 2             1 E.o               76              2              1     1.97
## 3             2 E.o               76              3              1     1.95
## 4             3 E.o               58              4              1     3.24
## 5             4 E.o               NA              5              1     0.85
## 6             5 E.o               59              6              1     2.62
## # … with 15 more variables: Orientation &lt;dbl&gt;, Number_of_Flowers &lt;int&gt;,
## #   Height_Inflo &lt;int&gt;, Herbivory &lt;chr&gt;, RowPosition_NF &lt;int&gt;,
## #   Number_Flowers_position &lt;int&gt;, Number_of_fruits &lt;int&gt;, Perc_FR_set &lt;dbl&gt;,
## #   pardalinum_or_roseum &lt;chr&gt;, Fruit_position_effect &lt;int&gt;,
## #   Frutos_si_o_no &lt;int&gt;, P_or_R_Infl_Lenght &lt;chr&gt;, `Num of fruits` &lt;int&gt;,
## #   Species_Name &lt;chr&gt;, `Cardinal orientation` &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb30-2"><a href="#cb30-2"></a>dipodium<span class="op">$</span>PropFR=dipodium<span class="op">$</span>Perc_FR_set<span class="fl">+0.0001</span> <span class="co"># solucionar para remover los cero</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">#dipodium$PropFR</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>dipodium2=dipodium <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="st">  </span><span class="kw">select</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance))</span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">#dipodium2</span></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="kw">write.csv</span>(<span class="dt">x=</span>dipodium2, <span class="dt">file=</span><span class="st">&quot;dipodium2.csv&quot;</span>)</span>
<span id="cb30-9"><a href="#cb30-9"></a></span>
<span id="cb30-10"><a href="#cb30-10"></a></span>
<span id="cb30-11"><a href="#cb30-11"></a><span class="kw">library</span>(readr)</span>
<span id="cb30-12"><a href="#cb30-12"></a>dipodium2 &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/dipodium2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## cols(
##   X1 = col_double(),
##   PropFR = col_double(),
##   Number_of_Flowers = col_double(),
##   Height_Inflo = col_double(),
##   Distance = col_double()
## )</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>modelpropFr=<span class="kw">betareg</span>(PropFR<span class="op">~</span>Number_of_Flowers<span class="op">+</span>Height_Inflo<span class="op">+</span>Distance, <span class="dt">data =</span><span class="kw">na.omit</span>(dipodium2))</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="kw">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers + Height_Inflo + Distance, 
##     data = na.omit(dipodium2))
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -3.8613 -0.4046  0.2672  0.8535  1.2798 
## 
## Coefficients (mean model with logit link):
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.796016   0.727139  -5.220 1.78e-07 ***
## Number_of_Flowers  0.076200   0.028247   2.698  0.00698 ** 
## Height_Inflo       0.006054   0.017847   0.339  0.73444    
## Distance          -0.111010   0.093825  -1.183  0.23674    
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.8382     0.9982   4.847 1.25e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 113.9 on 5 Df
## Pseudo R-squared: 0.2757
## Number of iterations: 19 (BFGS) + 2 (Fisher scoring)</code></pre>
</div>
<div id="visualizar-un-grafico-de-regresión-beta" class="section level2">
<h2>Visualizar un grafico de regresión beta</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>dipodiumbeta=dipodium2[,<span class="kw">c</span>(<span class="st">&quot;Number_of_Flowers&quot;</span>,<span class="st">&quot;PropFR&quot;</span>)] <span class="co"># crear un df con solamente las columnas de interes </span></span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a> dp2=dipodiumbeta[<span class="kw">complete.cases</span>(dipodiumbeta),] <span class="co"># remover los &quot;NA&quot; </span></span>
<span id="cb35-4"><a href="#cb35-4"></a> </span>
<span id="cb35-5"><a href="#cb35-5"></a>modelpropFr=<span class="kw">betareg</span>(PropFR<span class="op">~</span>Number_of_Flowers, <span class="dt">data=</span>dp2) <span class="co"># El modelo con solamente la explicativa</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="kw">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers, data = dp2)
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -3.3221 -0.3181  0.2414  0.8225  1.2346 
## 
## Coefficients (mean model with logit link):
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.88360    0.44251  -8.776  &lt; 2e-16 ***
## Number_of_Flowers  0.08259    0.01803   4.581 4.62e-06 ***
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.6947     0.9699    4.84  1.3e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 112.9 on 3 Df
## Pseudo R-squared: 0.2538
## Number of iterations: 18 (BFGS) + 1 (Fisher scoring)</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a> <span class="co">#head(dp2)</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co">#dp2$PropFR</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># calcular los valores estimados (predichos)</span></span></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## 0.02568523 0.02783519 0.03015954 0.04856508 0.05679268 0.05679268 0.05679268 
##          8          9         10         11         12         13         14 
## 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06631700 
##         15         16         17         18         19         20         21 
## 0.06631700 0.07161801 0.07161801 0.07161801 0.07161801 0.07730766 0.07730766 
##         22         23         24         25         26         27         28 
## 0.07730766 0.08340872 0.08340872 0.08994433 0.08994433 0.08994433 0.08994433 
##         29         30         31         32         33         34         35 
## 0.09693789 0.10441284 0.10441284 0.10441284 0.10441284 0.10441284 0.11239245 
##         36         37         38         39         40         41         42 
## 0.11239245 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 
##         43         44         45         46         47         48         49 
## 0.12995632 0.12995632 0.12995632 0.12995632 0.12995632 0.13958381 0.14980172 
##         50         51         52         53         54         55         56 
## 0.14980172 0.14980172 0.17207828 0.17207828 0.17207828 0.17207828 0.19690033 
##         57         58         59         60         61         62 
## 0.19690033 0.22433274 0.22433274 0.23903102 0.27035714 0.28695536</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>dp2<span class="op">$</span>response=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co">#dp2$link=predict(modelpropFr, type = &quot;link&quot;)</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>dp2<span class="op">$</span>precision=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;precision&quot;</span>)</span>
<span id="cb39-4"><a href="#cb39-4"></a>dp2<span class="op">$</span>variance=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;variance&quot;</span>)</span>
<span id="cb39-5"><a href="#cb39-5"></a>dp2<span class="op">$</span>quantile_.<span class="dv">25</span>=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">0.25</span>))</span>
<span id="cb39-6"><a href="#cb39-6"></a>dp2<span class="op">$</span>quantile_.<span class="dv">50</span>=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">0.50</span>))</span>
<span id="cb39-7"><a href="#cb39-7"></a>dp2<span class="op">$</span>quantile_.<span class="dv">75</span>=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">0.75</span>))</span>
<span id="cb39-8"><a href="#cb39-8"></a>dp2<span class="op">$</span>quantile_.<span class="dv">05</span>=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">0.05</span>))</span>
<span id="cb39-9"><a href="#cb39-9"></a>dp2<span class="op">$</span>quantile_.<span class="dv">95</span>=<span class="kw">predict</span>(modelpropFr, <span class="dt">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="fl">0.95</span>))</span>
<span id="cb39-10"><a href="#cb39-10"></a>dp2</span></code></pre></div>
<pre><code>## # A tibble: 62 x 10
##    Number_of_Flowe… PropFR response precision variance quantile_.25 quantile_.50
##               &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1                3 0.0001   0.0257      4.69  0.00439   0.00000151     0.000475
##  2                4 0.0001   0.0278      4.69  0.00475   0.00000371     0.000748
##  3                5 0.0001   0.0302      4.69  0.00514   0.00000848     0.00114 
##  4               11 0.0001   0.0486      4.69  0.00811   0.000372       0.00795 
##  5               13 0.0358   0.0568      4.69  0.00941   0.000928       0.0129  
##  6               13 0.0938   0.0568      4.69  0.00941   0.000928       0.0129  
##  7               13 0.0001   0.0568      4.69  0.00941   0.000928       0.0129  
##  8               14 0.0001   0.0614      4.69  0.0101    0.00139        0.0160  
##  9               14 0.364    0.0614      4.69  0.0101    0.00139        0.0160  
## 10               14 0.105    0.0614      4.69  0.0101    0.00139        0.0160  
## # … with 52 more rows, and 3 more variables: quantile_.75 &lt;dbl&gt;,
## #   quantile_.05 &lt;dbl&gt;, quantile_.95 &lt;dbl&gt;</code></pre>
<p>Al construir la figura para la regresión beta, una de las principales ventajas de utilizar este enfoque es que los cuartiles se calcula con una distribución beta. Por lo tanto, el margen de error NO baja de 0 y NO pasa de 1.</p>
<p>Evalua la siguiente figura en cada x hay una distribución beta, donde la linea roja representa ma mediana, las lineas verdes los cuartiles 25 y 75 y las lineas azules los cuartiles 5 y 95. NOTA que la distribución no es simétrica, y cambia a travez de la regresión.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="kw">ggplot</span>(dp2, <span class="kw">aes</span>(<span class="dt">x=</span>Number_of_Flowers, <span class="dt">y=</span>PropFR))<span class="op">+</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">width =</span> <span class="fl">0.05</span>, <span class="dt">height =</span> <span class="fl">0.01</span>)<span class="op">+</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>quantile_.<span class="dv">05</span>), <span class="dt">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>quantile_.<span class="dv">25</span>),<span class="dt">linetype=</span><span class="dv">2</span>, <span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>quantile_.<span class="dv">50</span>), <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>quantile_.<span class="dv">75</span>), <span class="dt">linetype=</span><span class="dv">2</span>, <span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>quantile_.<span class="dv">95</span>), <span class="dt">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Predicción de la proporción de frutos&quot;</span>)<span class="op">+</span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Números de Flores&quot;</span>)<span class="op">+</span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">25</span>, <span class="dt">y=</span><span class="fl">0.50</span>, <span class="dt">label=</span><span class="st">&quot;95th quartile&quot;</span>, <span class="dt">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="op">+</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">32</span>, <span class="dt">y=</span><span class="fl">0.39</span>, <span class="dt">label=</span><span class="st">&quot;75th quartile&quot;</span>, <span class="dt">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="op">+</span></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">33</span>, <span class="dt">y=</span><span class="fl">0.14</span>, <span class="dt">label=</span><span class="st">&quot;25th quartile&quot;</span>, <span class="dt">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="op">+</span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">33</span>, <span class="dt">y=</span><span class="fl">0.27</span>, <span class="dt">label=</span><span class="st">&quot;Median&quot;</span>, <span class="dt">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="op">+</span></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="dv">35</span>, <span class="dt">y=</span><span class="op">-</span><span class="fl">0.02</span>, <span class="dt">label=</span><span class="st">&quot;5th quartile&quot;</span>, <span class="dt">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="op">+</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb41-17"><a href="#cb41-17"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb41-18"><a href="#cb41-18"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb41-19"><a href="#cb41-19"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))<span class="op">+</span></span>
<span id="cb41-20"><a href="#cb41-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb41-21"><a href="#cb41-21"></a><span class="st">  </span>rlt_theme</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: width, height</code></pre>
<p><img src="TF7_Regresion_beta_files/figure-html/beta%20reg%20graph-1.png" width="672" /></p>
<p>Aquí es una representación de las distribuciones beta en las x, número de flores. En rojo es para simular la distribución la proporción esperada de frutos en plantas que tienen 15 flores y la linea azul es para simular la distribución esperada de la proporción de frutos en plantas con 30 flores.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">ggplot</span>(dipodium2, <span class="kw">aes</span>(PropFR))<span class="op">+</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">colour=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="op">+</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dipodium2<span class="op">$</span>PropFR, <span class="dt">y =</span> ..y..), <span class="dt">fun =</span> dbeta, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>, <span class="dt">n =</span> <span class="dv">62</span>,</span>
<span id="cb43-4"><a href="#cb43-4"></a>                      <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="fl">1.1</span>, <span class="dt">shape2 =</span><span class="dv">20</span>))<span class="op">+</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dipodium2<span class="op">$</span>PropFR, <span class="dt">y =</span> ..y..), <span class="dt">fun =</span> dbeta, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">n =</span> <span class="dv">62</span>,</span>
<span id="cb43-6"><a href="#cb43-6"></a>                      <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">shape1 =</span> <span class="dv">20</span>, <span class="dt">shape2 =</span><span class="dv">110</span>))</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<blockquote>
<p>“Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</blockquote>
<p><img src="Graficos/UPR_Logos.png" width="100%" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
