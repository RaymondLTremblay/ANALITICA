<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regressión beta</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados (en movimiento) 1</a>
    </li>
    <li>
      <a href="G15b_gganimate.html">Gráficos animados (en movimiento) 2</a>
    </li>
    <li>
      <a href="G15c_gganimate_barras.html">Gráficos animados (en movimiento) 3</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Talleres
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Documento_RMarkdown-ed">Una breve introducción a RMarkdown</a>
    </li>
    <li>
      <a href="Documento_dplyr">Una breve introducción a dplyr</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Taller para Facultad
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TF_1_Descripción.html">Descripción del taller</a>
    </li>
    <li>
      <a href="TF1_Regresion_Lineal.html">Regresión Lineal</a>
    </li>
    <li>
      <a href="TF2_Regresion_Cuadratica_otro.html">Regresión no lineal</a>
    </li>
    <li>
      <a href="TF3_Regresion_Multiples.html">Regresión Multiples</a>
    </li>
    <li>
      <a href="TF4_GLM.html">Modelos Lineales Generalizados</a>
    </li>
    <li>
      <a href="TF5_Regresion_logistica.html">Regresion Logística</a>
    </li>
    <li>
      <a href="TF6_Regresion_Poisson.html">Regresión Poisson</a>
    </li>
    <li>
      <a href="TF7_Regresion_beta.html">Regresión Beta</a>
    </li>
    <li>
      <a href="TF8_Akaike_Information_Criterion.html">Criterio de Selección</a>
    </li>
    <li>
      <a href="TF9_Ejercicio_Practica.html">Ejercicios de Practica</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datos.html">Los Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Regressión beta</h1>

</div>


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #437d66;
}
</style>
<p><img src="Graficos/Analitica.png" width="50%" /><img src="Graficos/UPR_IPERT_logo.png" width="50%" /> #Un cambio para modificar los gráficos</p>
<hr />
<div id="regressión-beta" class="section level2">
<h2>Regressión beta</h2>
<p>El método presentado aquí es bastante innovador (2010 en adelante). Desafortunadamente no hay mucha información en la literatura o el web sobre el método. Puede encontrar información suplementaria en el Vignette del paquete <strong>betareg</strong>.</p>
<p>Referencias:</p>
<p>Cribari-Neto, F., and Zeileis, A. (2010). Beta Regression in R. Journal of Statistical Software, 34(2), 1–24. <a href="http://www.jstatsoft.org/v34/i02/" class="uri">http://www.jstatsoft.org/v34/i02/</a>.</p>
<p>Grün, B., Kosmidis, I., and Zeileis, A. (2012). Extended Beta Regression in R: Shaken, Stirred, Mixed, and Partitioned. Journal of Statistical Software, 48(11), 1–25. <a href="http://www.jstatsoft.org/v48/i11/" class="uri">http://www.jstatsoft.org/v48/i11/</a>.</p>
<p>Articulo sobre regresión beta y diferentes paquetes de R que se puede usar para hacer los análisis <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.13234">Douma and Weedon 2019</a></p>
<hr />
</div>
<div id="qué-es-la-regresión-beta" class="section level1">
<h1>¿Qué es la Regresión beta?</h1>
<p>La regresión beta es una aproximación bajo GLM “Modelos lineales generalizado”. La regresión beta modela variables dependientes distribuidas con la distribución beta. Datos con la distribución beta incluyen proporciones y razones, donde los valores <span class="math inline">\(x\)</span> se encuentran entre 0 y 1 pero no inclusivo (i.e. <span class="math inline">\(0 &lt; x&lt; 1\)</span>). Además de producir una regresión que máxima la verosimilitud (tanto para la media como para la precisión de una respuesta distribuida en beta), se proporcionan estimaciones con corrección de sesgo.</p>
<p>Los valores de la variable de respuesta satisfacen <span class="math inline">\(0 &lt; x &lt; 1\)</span>. Por consecuencia si tiene valores que son 0 o 1, es necesario cambiarlos a <span class="math inline">\(0= 0.001\)</span> y <span class="math inline">\(1 = 0.999\)</span>. <strong>Los números no pueden ser 0 ni 1, deben ser mayores que 0 y menores que 1</strong>. Efectivamente a cambiar los los valores a <span class="math inline">\(0.001\)</span> y <span class="math inline">\(0.999\)</span> no tiene impacto sobre la interpretación de los datos, al menos que todos sus datos son solamente <span class="math inline">\(0\)</span> ó <span class="math inline">\(1\)</span>, en este caso no se debería usar esta herramienta pero una regresión logística.</p>
<p>El paquete “betareg” y sus datos. Tenga en cuenta que el enfoque del modelo GLM es desarrollar una regresión con la respuesta a través de una función de enlace y un predictor lineal. Igual como GLM normal, existen numerosas funciones de enlace, que pueden ser útil como “logit”, “probit”, “cloglog”, “cauchit”, “log”, “loglog” para linearizar los datos.</p>
<p>Casi toda la información que se estará presentando aquí proviene de Cribari-Neto y Zeileis (Beta Regression in R).</p>
<p>Consulte el pdf, <a href="https://cran.r-project.org/web/packages/betareg/betareg.pdf" class="uri">https://cran.r-project.org/web/packages/betareg/betareg.pdf</a> para obtener una descripción del paquete y más detalles.</p>
<p>Estaré usando datos diferentes a lo que se presenta en el paquete para demostrar el valor de los análisis.</p>
<hr />
<p>Errores típicos de análisis con datos que son fracciones.</p>
<p>Miramos un ejemplo. Aquí la relación entre el gasto se salud publica per capita en 156 paises y el porcentaje de niñas que no están en la escuela.</p>
<p>Datos del “World Development Agency”</p>
<div id="que-es-lo-que-obseva-que-no-tienen-sentido" class="section level2">
<h2>Que es lo que obseva que no tienen sentido?</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggversa)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Edu_Salud_Gastos_GDP</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Edu_Salud_Gastos_GDP, <span class="fu">aes</span>(Gasto_Salud_percapita, Porc_Ninas_no_escuela))<span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 46 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 46 rows containing missing values (geom_point).</code></pre>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Nota: - hay valores de proporciones negativa - el intervalo de confianza también es negativo - la dispersión de los datos en y alrededor de la media no es igual a medida que el gasto de salud per capita cambia (en x).</p>
<p>Los modelos usando la distribución beta resuelve estos asuntos.</p>
<hr />
</div>
<div id="primer-paso-que-es-una-distribución-beta" class="section level2">
<h2>Primer paso, que es una distribución beta?</h2>
<p>Lo más importante de la distribución beta es que los valores <strong>NUNCA</strong> son menores de 0 ni mayores de 1 (i.e. <span class="math inline">\(0 &lt; x &lt; 1\)</span>). En adición los intervalos de confianza tampoco no pueden ser ni menor de 0 ni mayor de 1.</p>
<p>Se construye múltiples conjuntos de datos con distribuciones beta distinta, para evaluar como se ve la distribuciones, nota que aquí los parametros no son el promedio y la sd, pero dos parámetros que se llama <strong>shape</strong>.</p>
<p>Aquí una serie de distribuciones beta. La distribución beta se calcula con dos parametros, <strong>shape 1 o <span class="math inline">\(\alpha\)</span></strong> y <strong>shape 2 o <span class="math inline">\(\beta\)</span></strong>. No vamos a entrar en estos parámetros, aunque pueden ir a la pagina de Wikipedia para tener más información. Deben fijarse en que si los parámetros no sin iguales (<span class="math inline">\(\alpha \neq \beta\)</span>) la distribución no es simétrica. Siempre hay una cola que se extiende en los valores pequeños o grandes.</p>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<hr />
</div>
<div id="wikipedia" class="section level2">
<h2>Wikipedia</h2>
<p>En la pagina de Wikipedia sobre distribución beta se puede apreciar como la distribución cambian cuando varia los parametros</p>
<p><a title="Pabloparsil, CC BY-SA 4.0 &lt;https://creativecommons.org/licenses/by-sa/4.0&gt;, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:PDF_of_the_Beta_distribution.gif"><img width="516" alt="PDF of the Beta distribution" src="https://upload.wikimedia.org/wikipedia/commons/7/78/PDF_of_the_Beta_distribution.gif"></a></p>
<hr />
</div>
<div id="propoción-de-fumadores-por-diferentes-paises." class="section level2">
<h2>Propoción de fumadores por diferentes paises.</h2>
<p>Los datos provienen de World Bank en el siguiente enlace, <a href="https://data.worldbank.org/indicator/SH.PRV.SMOK">Smokers</a>. Se encuentra información sobre 187 pais y la proporción de población mayor de 15 años que fuman.</p>
<p>Los datos están debajo pestaña de “Los Datos”</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Proportion_smokers_world <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/Proportion_smokers_world.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 187 Columns: 13
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (4): Country_Name, Country_Code, Indicator_Name, Indicator_Code
## dbl (9): Y2000, Y2005, Y2010, Y2011, Y2012, Y2013, Y2014, Y2015, Y2016
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Smokers<span class="ot">=</span>Proportion_smokers_world </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(<span class="fu">head</span>(Smokers))</span></code></pre></div>
<div id="dmvimujxif" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dmvimujxif .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dmvimujxif .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmvimujxif .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dmvimujxif .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dmvimujxif .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmvimujxif .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dmvimujxif .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dmvimujxif .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dmvimujxif .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dmvimujxif .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dmvimujxif .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dmvimujxif .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dmvimujxif .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dmvimujxif .gt_from_md > :first-child {
  margin-top: 0;
}

#dmvimujxif .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dmvimujxif .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dmvimujxif .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dmvimujxif .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dmvimujxif .gt_row_group_first td {
  border-top-width: 2px;
}

#dmvimujxif .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmvimujxif .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dmvimujxif .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dmvimujxif .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmvimujxif .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmvimujxif .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dmvimujxif .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dmvimujxif .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dmvimujxif .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmvimujxif .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmvimujxif .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dmvimujxif .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dmvimujxif .gt_left {
  text-align: left;
}

#dmvimujxif .gt_center {
  text-align: center;
}

#dmvimujxif .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dmvimujxif .gt_font_normal {
  font-weight: normal;
}

#dmvimujxif .gt_font_bold {
  font-weight: bold;
}

#dmvimujxif .gt_font_italic {
  font-style: italic;
}

#dmvimujxif .gt_super {
  font-size: 65%;
}

#dmvimujxif .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#dmvimujxif .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dmvimujxif .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#dmvimujxif .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#dmvimujxif .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Country_Name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Country_Code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Indicator_Name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Indicator_Code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2000</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2005</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2010</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2011</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2012</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2013</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2014</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2015</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Y2016</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Honduras</td>
<td class="gt_row gt_left">HND</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">3.9</td>
<td class="gt_row gt_right">3.1</td>
<td class="gt_row gt_right">2.5</td>
<td class="gt_row gt_right">2.4</td>
<td class="gt_row gt_right">2.4</td>
<td class="gt_row gt_right">2.3</td>
<td class="gt_row gt_right">2.2</td>
<td class="gt_row gt_right">2.1</td>
<td class="gt_row gt_right">2.0</td></tr>
    <tr><td class="gt_row gt_left">Ethiopia</td>
<td class="gt_row gt_left">ETH</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">4.8</td>
<td class="gt_row gt_right">4.6</td>
<td class="gt_row gt_right">4.5</td>
<td class="gt_row gt_right">4.4</td>
<td class="gt_row gt_right">4.5</td>
<td class="gt_row gt_right">4.4</td>
<td class="gt_row gt_right">4.4</td>
<td class="gt_row gt_right">4.4</td>
<td class="gt_row gt_right">4.4</td></tr>
    <tr><td class="gt_row gt_left">Congo, Rep.</td>
<td class="gt_row gt_left">COG</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">5.7</td>
<td class="gt_row gt_right">9.1</td>
<td class="gt_row gt_right">14.7</td>
<td class="gt_row gt_right">16.1</td>
<td class="gt_row gt_right">17.9</td>
<td class="gt_row gt_right">19.8</td>
<td class="gt_row gt_right">22.0</td>
<td class="gt_row gt_right">24.2</td>
<td class="gt_row gt_right">26.9</td></tr>
    <tr><td class="gt_row gt_left">Ghana</td>
<td class="gt_row gt_left">GHA</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">5.9</td>
<td class="gt_row gt_right">5.0</td>
<td class="gt_row gt_right">4.4</td>
<td class="gt_row gt_right">4.3</td>
<td class="gt_row gt_right">4.3</td>
<td class="gt_row gt_right">4.1</td>
<td class="gt_row gt_right">4.1</td>
<td class="gt_row gt_right">4.0</td>
<td class="gt_row gt_right">3.9</td></tr>
    <tr><td class="gt_row gt_left">Niger</td>
<td class="gt_row gt_left">NER</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">6.4</td>
<td class="gt_row gt_right">6.7</td>
<td class="gt_row gt_right">7.1</td>
<td class="gt_row gt_right">7.2</td>
<td class="gt_row gt_right">7.3</td>
<td class="gt_row gt_right">7.4</td>
<td class="gt_row gt_right">7.5</td>
<td class="gt_row gt_right">7.6</td>
<td class="gt_row gt_right">7.7</td></tr>
    <tr><td class="gt_row gt_left">Nigeria</td>
<td class="gt_row gt_left">NGA</td>
<td class="gt_row gt_left">Smoking prevalence, total (ages 15+)</td>
<td class="gt_row gt_left">SH.PRV.SMOK</td>
<td class="gt_row gt_right">7.7</td>
<td class="gt_row gt_right">7.0</td>
<td class="gt_row gt_right">6.3</td>
<td class="gt_row gt_right">6.2</td>
<td class="gt_row gt_right">6.1</td>
<td class="gt_row gt_right">6.1</td>
<td class="gt_row gt_right">5.9</td>
<td class="gt_row gt_right">5.8</td>
<td class="gt_row gt_right">5.8</td></tr>
  </tbody>
  
  
</table>
</div>
<hr />
<p>Primero vamos a convertir los datos en proporción ya que el programa tiene que utilizar datos mayor de 0 y menor de 1. Seleccionamos el año 2000 y creamos un histograma de la distribución.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Smokers<span class="sc">$</span>Y2000P<span class="ot">=</span>(Smokers<span class="sc">$</span>Y2000)<span class="sc">/</span><span class="dv">100</span> <span class="co"># convertir en proporción</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Smokers <span class="sc">%&gt;%</span> <span class="fu">select</span>(Country_Name, Y2000P)</span></code></pre></div>
<pre><code>## # A tibble: 187 × 2
##    Country_Name Y2000P
##    &lt;chr&gt;         &lt;dbl&gt;
##  1 Honduras      0.039
##  2 Ethiopia      0.048
##  3 Congo, Rep.   0.057
##  4 Ghana         0.059
##  5 Niger         0.064
##  6 Nigeria       0.077
##  7 Oman          0.082
##  8 Barbados      0.083
##  9 Eritrea       0.087
## 10 Benin         0.091
## # … with 177 more rows</code></pre>
<hr />
</div>
<div id="convertir-el-promedio-y-varianza-en-shape-alpha-y-beta" class="section level2">
<h2>Convertir el promedio y varianza en shape <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span></h2>
<p>Convertir el promedio y la varianza de los datos en los valores del shape <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Se usa la siguiente para calcular los shapes. Los valores esperado y la varianza se comportan de forma distinta.</p>
<p><span class="math display">\[E(X) = \frac{\alpha}{\alpha+\beta}\]</span></p>
<p><span class="math display">\[V(X) = \frac{\alpha\beta}{(\alpha+\beta+1)(\alpha+\beta)^2}\]</span></p>
<p>Usando el promedio y varianza se puede convertir en <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> con la siguiente ecuaciones</p>
<p><span class="math display">\[\alpha = \frac{1-mu}{(var-1)/mu}*mu^2\]</span> <span class="math display">\[\beta = \alpha*(\frac{1}{mu}-1)\]</span> Aquí un script para convertir los parametros en shape</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>estBetaParams <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, var) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">/</span> var <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> mu) <span class="sc">*</span> mu <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> mu <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#mean(Smokers$Y2000P)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#var(Smokers$Y2000P)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">estBetaParams</span>((<span class="fu">mean</span>(Smokers<span class="sc">$</span>Y2000P)), (<span class="fu">var</span>(Smokers<span class="sc">$</span>Y2000P)))</span></code></pre></div>
<pre><code>## $alpha
## [1] 3.592488
## 
## $beta
## [1] 9.181559</code></pre>
<p>Ahora comparamos la distribución beta y normal de los datos de los fumadores de mayores de 15 años</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Smokers<span class="sc">$</span>Y2000P<span class="ot">=</span>(Smokers<span class="sc">$</span>Y2000)<span class="sc">/</span><span class="dv">100</span> <span class="co"># convertir en proporción</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#mean(Smokers$Y2000P)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#var(Smokers$Y2000P)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Smokers, <span class="fu">aes</span>(Y2000P))<span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">colour=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> Smokers<span class="sc">$</span>Y2000P, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">3.593</span>, <span class="at">shape2 =</span> <span class="fl">9.185</span>))<span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Smokers<span class="sc">$</span>Y2000P, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">sd =</span> <span class="fu">sd</span>(Smokers<span class="sc">$</span>Y2000P, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)), </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Proporción de fumadores de mayor </span><span class="sc">\n</span><span class="st"> de 15 años por Pais&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> <span class="fl">4.2</span>, <span class="at">label =</span> <span class="st">&quot;Verde: dist Normal&quot;</span>, <span class="at">color=</span><span class="st">&quot;darkgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">5</span>, <span class="at">y =</span> <span class="fl">3.7</span>, <span class="at">label =</span> <span class="st">&quot;Verde: dist Beta&quot;</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_bar).</code></pre>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<hr />
<p>Calculando el intervalo de confianza del promedio de una distribución beta. Se necesita los siguientes paquetes <strong>simpleboot , boot</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(simpleboot)</span></code></pre></div>
<pre><code>## Simple Bootstrap Routines (1.1-7)</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co"># paquete para calcular el intervalo de confianza de una distribución beta</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">187</span> <span class="co"># El tamaño de muestra de los datos</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">3.593</span> <span class="co"># estimado de la función arriba </span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> <span class="fl">9.185</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rbeta</span>(n, alpha, beta)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>x.boot <span class="ot">=</span> <span class="fu">one.boot</span>(x, median, <span class="at">R=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>) <span class="co"># Aquí se usa la mediana, pq el promedio *mean* sera sesgado a la derecha.  </span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(x.boot, <span class="at">type=</span><span class="st">&quot;bca&quot;</span>)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = x.boot, type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   ( 0.2361,  0.2948 )  
## Calculations and Intervals on Original Scale</code></pre>
<hr />
</div>
</div>
<div id="visualización-de-la-distribución" class="section level1">
<h1>Visualización de la distribución</h1>
<p>Sobreponemos el intervalo de confianza de la mediana sobre la distribución beta</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Smokers, <span class="fu">aes</span>(Y2000P))<span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">bins=</span><span class="dv">20</span>, <span class="at">colour=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;grey50&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> Smokers<span class="sc">$</span>Y2000P, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">3.593</span>, <span class="at">shape2 =</span> <span class="fl">9.185</span>))<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fl">0.2320</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span> <span class="co"># El intervalo de confianza del promedio</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span><span class="fl">0.2768</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  rlt_theme<span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Proporción de fumadores por Pais&quot;</span>)</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(betareg) <span class="co"># El paquete para hacer regresión beta</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggversa) <span class="co"># paquete para los datos</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(dipodium)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dipodium, <span class="at">n=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 21
##   `Tree Number` `Tree species`   DBH `Plant number` `Ramet number` Distance
##           &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;          &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt;
## 1             1 E.o               75              1              1     2.47
## 2             1 E.o               76              2              1     1.97
## 3             2 E.o               76              3              1     1.95
## 4             3 E.o               58              4              1     3.24
## # … with 15 more variables: Orientation &lt;dbl&gt;, Number_of_Flowers &lt;int&gt;,
## #   Height_Inflo &lt;int&gt;, Herbivory &lt;chr&gt;, RowPosition_NF &lt;int&gt;,
## #   Number_Flowers_position &lt;int&gt;, Number_of_fruits &lt;int&gt;, Perc_FR_set &lt;dbl&gt;,
## #   pardalinum_or_roseum &lt;chr&gt;, Fruit_position_effect &lt;int&gt;,
## #   Frutos_si_o_no &lt;int&gt;, P_or_R_Infl_Lenght &lt;chr&gt;, `Num of fruits` &lt;int&gt;,
## #   Species_Name &lt;chr&gt;, `Cardinal orientation` &lt;int&gt;</code></pre>
<hr />
<div id="regresión-beta-proporción-de-frutos-por-cantidad-de-flores" class="section level2">
<h2>Regresión beta, proporción de frutos por cantidad de flores</h2>
<div class="figure">
<img src="Graficos/dipodium_roseum.jpg" alt="from this webpage: https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/" width="150" style="float:right; padding:10px" />
<p class="caption">
from this webpage: <a href="https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/" class="uri">https://binalongbungalows.wordpress.com/tasmanian-orchids/dipodium-roseum-rosy-hyacinth-orchid-0615-web/</a>
</p>
</div>
<p>Ahora haremos el primer análisis de regresión donde nuestra respuesta es una proporción.</p>
<p>Los datos provienen de una especie de orquidea de Australia, <em>Dipodium roseum</em>, recolectado por RLT en 2004-2005. Vamos a evaluar la relación entre el número de flores y la proporción de frutos por planta. El primer paso es asegarar que no haya valores de 0 y 1. En este caso no hay ni una planta que tiene 100% de frutos, pero si hay individuos que tienen cero frutos.</p>
<ul>
<li><p>RECUERDA x &gt;0 y &lt;1. NO se acepta 0 o 1. Entonces a los valores de 0 se le puede añadir un valor mínimo como 0.001 y a los 1 restar 0.001. En realidad esta modificación no impacta la interpretación de los resultados.</p></li>
<li><p>se remueva también del archivo los NA.</p></li>
<li><p>Nota que el modelo se construye como un modelo lineal <strong>betareg(y~x, data =na.omit(df))</strong>. Las variables del archivo son <strong>PropFR</strong>, el proporción de frutos (número de frutos/números de flores) por cada individuo y el número de flores, <strong>Number_of_Flowers</strong>.</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#head(dipodium)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>dipodium<span class="sc">$</span>PropFR<span class="ot">=</span>dipodium<span class="sc">$</span>Perc_FR_set<span class="fl">+0.0001</span> <span class="co"># solucionar para remover los cero</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#dipodium$PropFR</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dipodium2<span class="ot">=</span>dipodium <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(PropFR, Number_of_Flowers,Height_Inflo, Distance))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#dipodium2</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="at">x=</span>dipodium2, <span class="at">file=</span><span class="st">&quot;dipodium2.csv&quot;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>dipodium2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Data/dipodium2.csv&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## * `` -&gt; ...1</code></pre>
<pre><code>## Rows: 62 Columns: 5
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (5): ...1, PropFR, Number_of_Flowers, Height_Inflo, Distance
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>modelpropFr<span class="ot">=</span><span class="fu">betareg</span>(PropFR<span class="sc">~</span>Number_of_Flowers<span class="sc">+</span>Height_Inflo<span class="sc">+</span>Distance, <span class="at">data =</span><span class="fu">na.omit</span>(dipodium2))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers + Height_Inflo + Distance, 
##     data = na.omit(dipodium2))
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -3.8613 -0.4046  0.2672  0.8535  1.2798 
## 
## Coefficients (mean model with logit link):
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.796016   0.727139  -5.220 1.78e-07 ***
## Number_of_Flowers  0.076200   0.028247   2.698  0.00698 ** 
## Height_Inflo       0.006054   0.017847   0.339  0.73444    
## Distance          -0.111010   0.093825  -1.183  0.23674    
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.8382     0.9982   4.847 1.25e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 113.9 on 5 Df
## Pseudo R-squared: 0.2757
## Number of iterations: 19 (BFGS) + 2 (Fisher scoring)</code></pre>
<hr />
</div>
<div id="visualizar-un-gráfico-de-regresión-beta" class="section level2">
<h2>Visualizar un gráfico de regresión beta</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dipodiumbeta<span class="ot">=</span>dipodium2[,<span class="fu">c</span>(<span class="st">&quot;Number_of_Flowers&quot;</span>,<span class="st">&quot;PropFR&quot;</span>)] <span class="co"># crear un df con solamente las columnas de interes </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a> dp2<span class="ot">=</span>dipodiumbeta[<span class="fu">complete.cases</span>(dipodiumbeta),] <span class="co"># remover los &quot;NA&quot; </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>modelpropFr<span class="ot">=</span><span class="fu">betareg</span>(PropFR<span class="sc">~</span>Number_of_Flowers, <span class="at">data=</span>dp2) <span class="co"># El modelo con solamente la explicativa</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelpropFr)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = PropFR ~ Number_of_Flowers, data = dp2)
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -3.3221 -0.3181  0.2414  0.8225  1.2346 
## 
## Coefficients (mean model with logit link):
##                   Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.88360    0.44251  -8.776  &lt; 2e-16 ***
## Number_of_Flowers  0.08259    0.01803   4.581 4.62e-06 ***
## 
## Phi coefficients (precision model with identity link):
##       Estimate Std. Error z value Pr(&gt;|z|)    
## (phi)   4.6947     0.9699    4.84  1.3e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 112.9 on 3 Df
## Pseudo R-squared: 0.2538
## Number of iterations: 18 (BFGS) + 1 (Fisher scoring)</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#head(dp2)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dp2$PropFR</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="co"># calcular los valores estimados (predichos)</span></span></code></pre></div>
<pre><code>##          1          2          3          4          5          6          7 
## 0.02568523 0.02783519 0.03015954 0.04856508 0.05679268 0.05679268 0.05679268 
##          8          9         10         11         12         13         14 
## 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06138242 0.06631700 
##         15         16         17         18         19         20         21 
## 0.06631700 0.07161801 0.07161801 0.07161801 0.07161801 0.07730766 0.07730766 
##         22         23         24         25         26         27         28 
## 0.07730766 0.08340872 0.08340872 0.08994433 0.08994433 0.08994433 0.08994433 
##         29         30         31         32         33         34         35 
## 0.09693789 0.10441284 0.10441284 0.10441284 0.10441284 0.10441284 0.11239245 
##         36         37         38         39         40         41         42 
## 0.11239245 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 0.12089957 
##         43         44         45         46         47         48         49 
## 0.12995632 0.12995632 0.12995632 0.12995632 0.12995632 0.13958381 0.14980172 
##         50         51         52         53         54         55         56 
## 0.14980172 0.14980172 0.17207828 0.17207828 0.17207828 0.17207828 0.19690033 
##         57         58         59         60         61         62 
## 0.19690033 0.22433274 0.22433274 0.23903102 0.27035714 0.28695536</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>response<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dp2$link=predict(modelpropFr, type = &quot;link&quot;)</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>precision<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;precision&quot;</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>variance<span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;variance&quot;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.01</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.01</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.05</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.05</span>))</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.10</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.10</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.15</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.15</span>))</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.20</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.20</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.25</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.25</span>))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.30</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.30</span>))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.35</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.35</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.40</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.40</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.45</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.45</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.50</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.50</span>))</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.55</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.55</span>))</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.60</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.60</span>))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.65</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.65</span>))</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.70</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.70</span>))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.75</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.75</span>))</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.80</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.80</span>))</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.85</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.85</span>))</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.90</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.90</span>))</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.95</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.95</span>))</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>dp2<span class="sc">$</span>quantile_<span class="fl">.99</span><span class="ot">=</span><span class="fu">predict</span>(modelpropFr, <span class="at">type =</span> <span class="st">&quot;quantile&quot;</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="fl">0.99</span>))</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>dp2</span></code></pre></div>
<pre><code>## # A tibble: 62 × 26
##    Number_of_Flowe… PropFR response precision variance quantile_.01 quantile_.05
##               &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1                3 0.0001   0.0257      4.69  0.00439     3.86e-18     2.42e-12
##  2                4 0.0001   0.0278      4.69  0.00475     7.44e-17     1.66e-11
##  3                5 0.0001   0.0302      4.69  0.00514     1.14e-15     9.81e-11
##  4               11 0.0001   0.0486      4.69  0.00811     2.75e-10     3.20e- 7
##  5               13 0.0358   0.0568      4.69  0.00941     5.29e- 9     2.21e- 6
##  6               13 0.0938   0.0568      4.69  0.00941     5.29e- 9     2.21e- 6
##  7               13 0.0001   0.0568      4.69  0.00941     5.29e- 9     2.21e- 6
##  8               14 0.0001   0.0614      4.69  0.0101      1.96e- 8     5.21e- 6
##  9               14 0.364    0.0614      4.69  0.0101      1.96e- 8     5.21e- 6
## 10               14 0.105    0.0614      4.69  0.0101      1.96e- 8     5.21e- 6
## # … with 52 more rows, and 19 more variables: quantile_.10 &lt;dbl&gt;,
## #   quantile_.15 &lt;dbl&gt;, quantile_.20 &lt;dbl&gt;, quantile_.25 &lt;dbl&gt;,
## #   quantile_.30 &lt;dbl&gt;, quantile_.35 &lt;dbl&gt;, quantile_.40 &lt;dbl&gt;,
## #   quantile_.45 &lt;dbl&gt;, quantile_.50 &lt;dbl&gt;, quantile_.55 &lt;dbl&gt;,
## #   quantile_.60 &lt;dbl&gt;, quantile_.65 &lt;dbl&gt;, quantile_.70 &lt;dbl&gt;,
## #   quantile_.75 &lt;dbl&gt;, quantile_.80 &lt;dbl&gt;, quantile_.85 &lt;dbl&gt;,
## #   quantile_.90 &lt;dbl&gt;, quantile_.95 &lt;dbl&gt;, quantile_.99 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modelpropFr$precision</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co">#quantile_many=predict(modelpropFr, type = &quot;quantile&quot;, at=c(.99))</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co">#quantile_many</span></span></code></pre></div>
<p>Al construir la figura para la regresión beta, una de las principales ventajas de utilizar este enfoque es que los cuartiles se calcula con una distribución beta. Por lo tanto, el margen de error NO baja de 0 y NO pasa de 1.</p>
<p>Evalua la siguiente figura en cada x hay una distribución beta, donde la linea roja representa una mediana, las lineas verdes son los cuartiles 25 y 75 y las lineas azules las percentilas 5 y 95. NOTA que la distribución no es simétrica, y cambia a travez de la regresión.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dp2, <span class="fu">aes</span>(<span class="at">x=</span>Number_of_Flowers, <span class="at">y=</span>PropFR))<span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.05</span>), <span class="at">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.25</span>),<span class="at">linetype=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.50</span>), <span class="at">colour=</span><span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.75</span>), <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">colour=</span><span class="st">&quot;green&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>quantile_<span class="fl">.95</span>), <span class="at">linetype=</span><span class="st">&quot;twodash&quot;</span>, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Predicción de la proporción de frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Números de Flores&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">25</span>, <span class="at">y=</span><span class="fl">0.50</span>, <span class="at">label=</span><span class="st">&quot;95th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">32</span>, <span class="at">y=</span><span class="fl">0.39</span>, <span class="at">label=</span><span class="st">&quot;75th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">33</span>, <span class="at">y=</span><span class="fl">0.14</span>, <span class="at">label=</span><span class="st">&quot;25th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">33</span>, <span class="at">y=</span><span class="fl">0.27</span>, <span class="at">label=</span><span class="st">&quot;Median&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">35</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">0.02</span>, <span class="at">label=</span><span class="st">&quot;5th quartile&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;italic&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>), </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">face=</span><span class="st">&quot;bold&quot;</span>))<span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  rlt_theme</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/beta%20reg%20graph-1.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Graficos/Beta_number_flowers.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p>Esto es una representación de las distribuciones beta en las x, número de flores. En rojo simulamos la distribución de la proporción esperada de frutos en plantas que tienen 15 flores y en la linea azul simulamos la distribución esperada de la proporción de frutos en plantas con 30 flores.</p>
<hr />
</div>
<div id="comparar-el-modelo-tradicional-lineal-versus-un-modelo-beta" class="section level2">
<h2>Comparar el modelo tradicional lineal versus un modelo beta</h2>
<p>Para comparar efectivadad de los modelos usamos el Akaike Information Criterion (AIC). En un acercmiento de selección modelo se acepta como mejor modelo el indice de AIC más pequeño, que representa el modelo meas parsimonio. Una diferencia de AIC DE 4 es significativo. Nota que el modelo beta es mucho mejor (AIC = -219) que el modelo de regresión lineal (AIC = -102)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC(modelpropFr) # modelo beta</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>modelpropFr_lm<span class="ot">=</span><span class="fu">lm</span>(PropFR<span class="sc">~</span>Number_of_Flowers, <span class="at">data=</span>dp2)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelpropFr,modelpropFr_lm)</span></code></pre></div>
<pre><code>##                df       AIC
## modelpropFr     3 -219.8470
## modelpropFr_lm  3 -102.3526</code></pre>
<hr />
</div>
<div id="distribución-de-valores-especificos" class="section level2">
<h2>Distribución de valores especificos</h2>
<p>Evaluando la distribución de beta para valores específicos de x= Proporción de frutos por plantas basado en la cantidad de flores en la planta.</p>
<p>Seleccionar los diferentes valores de <strong>x</strong> y calcular el promedio y la varianza y convertir estos en <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span>. Con estos parámetros se puede construir la densidad de la distribución por cada valor de x.</p>
<p>Se seleccionan valores específicos para la visualizar la distribución, las plantas que tienen 25, 30 y 35 flores. Se tiene que reorganizar los datos para calcular el promedio y la varianza.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dpQ<span class="ot">=</span>dp2 <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">26</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>dpQ2<span class="ot">=</span>dpQ<span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Number_of_Flowers<span class="sc">==</span> <span class="dv">35</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">22</span>))<span class="sc">%&gt;%</span> t <span class="sc">%&gt;%</span> as.data.frame</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>dpQ2<span class="sc">$</span>Quartiles<span class="ot">=</span><span class="fu">c</span>(.<span class="dv">01</span>, <span class="fl">0.05</span>, .<span class="dv">1</span>, .<span class="dv">15</span>, .<span class="dv">2</span>, .<span class="dv">25</span>, .<span class="dv">30</span>, .<span class="dv">35</span>, .<span class="dv">4</span>, .<span class="dv">45</span>, .<span class="dv">5</span>, .<span class="dv">55</span>, .<span class="dv">6</span>, .<span class="dv">65</span>,  .<span class="dv">7</span>,.<span class="dv">75</span>, .<span class="dv">8</span>, .<span class="dv">85</span>, .<span class="dv">9</span>, .<span class="dv">95</span>, .<span class="dv">99</span> )</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dpQ2<span class="sc">$</span>V1, <span class="at">na.rm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.2757771</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(dpQ2<span class="sc">$</span>V1, <span class="at">na.rm=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.04226223</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dpQ2</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dpQ2, <span class="fu">aes</span>(Quartiles, V1))<span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Usando la varianza calculada en el chunk anterior, se puede calcular el <span class="math inline">\(\alpha\)</span> y el <span class="math inline">\(\beta\)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>estBetaParams <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, var) {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> ((<span class="dv">1</span> <span class="sc">-</span> mu) <span class="sc">/</span> var <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span> mu) <span class="sc">*</span> mu <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> alpha <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> mu <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">params =</span> <span class="fu">list</span>(<span class="at">alpha =</span> alpha, <span class="at">beta =</span> beta))</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#mean(Smokers$Y2000P)</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">#var(Smokers$Y2000P)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">estBetaParams</span>(<span class="fl">0.2757771</span>,<span class="fl">0.04226223</span>)</span></code></pre></div>
<pre><code>## $alpha
## [1] 1.027498
## 
## $beta
## [1] 2.698331</code></pre>
<hr />
<p>Producción de los gráficos. Se observa que para las plantas que tienen 25 y 30 flores la densidad esta sesgada a la izquierda, en otra palabra la probabilidad de tener pocas frutos domina la distribuciones.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;red&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span><span class="fl">0.5418068</span>, <span class="at">shape2 =</span><span class="fl">3.135593</span>))<span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.05</span>))<span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 25 flores&quot;</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.7549048</span>, <span class="at">shape2 =</span><span class="fl">2.949404</span>))<span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 30 flores&quot;</span>)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>c<span class="ot">=</span><span class="fu">ggplot</span>(dipodium2, <span class="fu">aes</span>(PropFR))<span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="fu">aes</span>(<span class="at">x =</span> dipodium2<span class="sc">$</span>PropFR, <span class="at">y =</span> ..y..), <span class="at">fun =</span> dbeta, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">n =</span> <span class="dv">62</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">args =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">1.027498</span>, <span class="at">shape2 =</span><span class="fl">2.698331</span>))<span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Beta </span><span class="sc">\n</span><span class="st">Density&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Probabilidad de tener frutos&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.10</span>))<span class="sc">+</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Densidad beta para plantas con 35 flores&quot;</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>tresDensidad<span class="ot">=</span><span class="fu">grid.arrange</span>(a,b,c, <span class="at">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tresDensidad</span></code></pre></div>
<pre><code>## TableGrob (3 x 1) &quot;arrange&quot;: 3 grobs
##   z     cells    name           grob
## 1 1 (1-1,1-1) arrange gtable[layout]
## 2 2 (2-2,1-1) arrange gtable[layout]
## 3 3 (3-3,1-1) arrange gtable[layout]</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&quot;Graficos/tresDensidad.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p>Un segundo ejemplo</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;StressAnxiety&quot;</span>, <span class="at">package =</span> <span class="st">&quot;betareg&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>StressAnxiety <span class="ot">&lt;-</span> StressAnxiety[<span class="fu">order</span>(StressAnxiety<span class="sc">$</span>stress),]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Smithson &amp; Verkuilen (2006, Table 4)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>sa_null <span class="ot">&lt;-</span> <span class="fu">betareg</span>(anxiety <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> <span class="dv">1</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> StressAnxiety, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>sa_stress <span class="ot">&lt;-</span> <span class="fu">betareg</span>(anxiety <span class="sc">~</span> stress <span class="sc">|</span> stress,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> StressAnxiety, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sa_null)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = anxiety ~ 1 | 1, data = StressAnxiety, hessian = TRUE)
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -0.6806 -0.6806 -0.2705  0.6581  2.0002 
## 
## Coefficients (mean model with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.24396    0.09879  -22.71   &lt;2e-16 ***
## 
## Phi coefficients (precision model with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    1.796      0.123    14.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood: 239.4 on 2 Df
## Number of iterations in BFGS optimization: 9</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sa_stress)</span></code></pre></div>
<pre><code>## 
## Call:
## betareg(formula = anxiety ~ stress | stress, data = StressAnxiety, hessian = TRUE)
## 
## Standardized weighted residuals 2:
##     Min      1Q  Median      3Q     Max 
## -2.3686 -0.6704 -0.0024  0.6213  2.0510 
## 
## Coefficients (mean model with logit link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -4.0237     0.1442  -27.90   &lt;2e-16 ***
## stress        4.9414     0.4409   11.21   &lt;2e-16 ***
## 
## Phi coefficients (precision model with log link):
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   3.9608     0.2511  15.776  &lt; 2e-16 ***
## stress       -4.2733     0.7532  -5.674  1.4e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Type of estimator: ML (maximum likelihood)
## Log-likelihood:   302 on 4 Df
## Pseudo R-squared: 0.4748
## Number of iterations in BFGS optimization: 16</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(sa_null, sa_stress)</span></code></pre></div>
<pre><code>##           df       AIC
## sa_null    2 -474.8960
## sa_stress  4 -595.9202</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">as.vector</span>(<span class="fu">logLik</span>(sa_null)<span class="sc">/</span><span class="fu">logLik</span>(sa_stress))</span></code></pre></div>
<pre><code>## [1] 0.207021</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="do">## visualization</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(StressAnxiety)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(anxiety) <span class="sc">~</span> <span class="fu">jitter</span>(stress),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Stress&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Anxiety&quot;</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(anxiety <span class="sc">~</span> stress))</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(sa_stress) <span class="sc">~</span> stress, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(<span class="fu">lm</span>(anxiety <span class="sc">~</span> stress)) <span class="sc">~</span> stress, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;lowess&quot;</span>, <span class="st">&quot;betareg&quot;</span>, <span class="st">&quot;lm&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="TF7_Regresion_beta_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(StressAnxiety)</span></code></pre></div>
<blockquote>
<p>“Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</blockquote>
<p><img src="Graficos/UPR_Logos.png" width="100%" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
