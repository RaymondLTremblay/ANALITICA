<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regresion Multiple</title>

<script src="site_libs/header-attrs-2.4/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ff0000; font-weight: bold; } /* Alert */
      code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #7d9029; } /* Attribute */
      code span.bn { color: #40a070; } /* BaseN */
      code span.bu { } /* BuiltIn */
      code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4070a0; } /* Char */
      code span.cn { color: #880000; } /* Constant */
      code span.co { color: #60a0b0; font-style: italic; } /* Comment */
      code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #ba2121; font-style: italic; } /* Documentation */
      code span.dt { color: #902000; } /* DataType */
      code span.dv { color: #40a070; } /* DecVal */
      code span.er { color: #ff0000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #40a070; } /* Float */
      code span.fu { color: #06287e; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #007020; font-weight: bold; } /* Keyword */
      code span.op { color: #666666; } /* Operator */
      code span.ot { color: #007020; } /* Other */
      code span.pp { color: #bc7a00; } /* Preprocessor */
      code span.sc { color: #4070a0; } /* SpecialChar */
      code span.ss { color: #bb6688; } /* SpecialString */
      code span.st { color: #4070a0; } /* String */
      code span.va { color: #19177c; } /* Variable */
      code span.vs { color: #4070a0; } /* VerbatimString */
      code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados en movimiento</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sreencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="screencast_t_test.html">t-test Screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Lo básico de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Lo básico de RMarkdown</a>
    </li>
    <li>
      <a href="Tendencias_Centrales.html"> Tendencias Centrales</a>
    </li>
    <li>
      <a href="Medidas_Dispersión.html"> Medidas de Dispersión</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taller para Facultad
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TF_1_Descripción.html">Descripción del taller</a>
    </li>
    <li>
      <a href="TF1_Regresion_Lineal.html">Regresion_Lineal</a>
    </li>
    <li>
      <a href="TF2_Regresion_Cuadratica_otro.html">Regresion no lineal</a>
    </li>
    <li>
      <a href="TF3_Regresion_Multiples.html">Regresion Multiples</a>
    </li>
    <li>
      <a href="TF4_GLM.html">Modelos Lineales Generalizados</a>
    </li>
    <li>
      <a href="TF5_Regresion_logistica.html">Regresion Logística</a>
    </li>
    <li>
      <a href="TF6_Regresion_Poisson.html">Regresion Poisson</a>
    </li>
    <li>
      <a href="TF7_Regresion_beta.html">Regresion Beta</a>
    </li>
    <li>
      <a href="TF8_Akaike_Information_Criterion.html">Criterio de Selección</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datos.html">Los Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Regresion Multiple</h1>

</div>


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #437d66;
}
</style>
<p><img src="Graficos/Analitica.png" width="50%" /><img src="Graficos/UPR_IPERT_logo.png" width="50%" /></p>
<hr />
<div id="regresión-múltiple" class="section level1">
<h1>Regresión Múltiple</h1>
<div id="lista-de-paquetes-a-instalar" class="section level4">
<h4>Lista de paquetes a instalar</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: pacman</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>pacman<span class="op">::</span><span class="kw">p_load</span>(car, EnvStats,tidyverse, coefplot, leaps,</span>
<span id="cb3-2"><a href="#cb3-2"></a>              rmarkdown, ggplot2, MASS, multcomp, effects, </span>
<span id="cb3-3"><a href="#cb3-3"></a>              gplots,agricolae, caret )</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># Activar los paquetes</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">library</span>(ggversa)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">library</span>(knitr)</span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">library</span>(coefplot)</span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="kw">library</span>(leaps)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">library</span>(EnvStats)</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="kw">library</span>(MASS)</span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="kw">library</span>(car) <span class="co"># Companion to applied regression</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="kw">library</span>(ggplot2)  <span class="co"># Data Visualization</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="kw">library</span>(effects)</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">library</span>(gplots) </span></code></pre></div>
<hr />
</div>
<div id="lista-de-archivos-a-usar" class="section level4">
<h4>Lista de archivos a usar</h4>
<p>Los siguientes archivos deben estar disponible en su directorio de trabajo de R:</p>
<ul>
<li><a href="https://drive.google.com/open?id=1kKD0vOoQCBjgoecqvdcdwFiJuiEyaz-U">mod_empiricos.xlsx</a><br />
</li>
<li><a href="https://drive.google.com/open?id=1ATmAlI0I6K9m2GG0uukhH_72zQkTJQps">strain_sex_chol.xlsx</a></li>
<li><a href="https://drive.google.com/open?id=1scOVpqtb6c9EbM90m0pZm3zg98Khde_o">Titanic.xlsx</a></li>
</ul>
<hr />
</div>
<div id="objetivos-generales" class="section level3">
<h3>Objetivos Generales</h3>
<ul>
<li>Conocer y aplicar los métodos disponibles en R para obtener los parámetros de <strong>modelos de regresión múltiple</strong>, evaluar su idoneidad para describir los datos, e interpretar su significado.</li>
</ul>
<hr />
</div>
</div>
<div id="regresión-lineal-múltiple" class="section level1">
<h1>Regresión Lineal Múltiple</h1>
<p>Cuando tenemos más de una variable predictora (“independiente”), la regresión lineal simple viene a ser una <strong>regresión múltiple</strong>. El objetivo es de simultaneamente evaluar múltiples variables independiente. La idea es de determinar cual impacto cada una de las variables independiente tiene sobre la variable dependiente considerando que hay otras variables independientes.</p>
<p>La <span class="math inline">\(\alpha\)</span> es el intercepto, las <span class="math inline">\(B_i\)</span> son los coeficientes para cada variable independientes y el <span class="math inline">\(\epsilon\)</span> es el error.</p>
<p><span class="math display">\[Y_j=\alpha+\beta_1X_{1j}+\beta_2X_{2j}+...+\beta_nX_{nj}+\epsilon\]</span></p>
<div id="ejemplo-1-y-datos" class="section level4">
<h4>Ejemplo 1 y Datos</h4>
<p>Usaremos como ejemplo los datos <em>bmi</em> en el archivo <em>mod_empiricos.xlsx</em>. Estos son datos de individuos adultos entre 21 y 79 años, con las siguientes variables: <em>BMI</em>, índice de masa corporal (<span class="math inline">\(kg/m^{2}\)</span>); <em>Age</em>, edad (<em>años</em>); <em>Cholesterol</em>, niveles de colesterol en sangre, (<span class="math inline">\(mg/dL\)</span>); <em>Glucose</em>, niveles de glucosa en la sangre, (<span class="math inline">\(mg/dL\)</span>).</p>
<p>Para leer los datos emplearemos el siguiente código (obtenido del menú <em>Import Dataset/From Excel</em>):</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">library</span>(readxl)</span>
<span id="cb4-2"><a href="#cb4-2"></a>reg.multiple &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Data/mod_empiricos.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;bmi&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># para ver las primeras seis filas de datos</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">head</span>(reg.multiple)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##     BMI   Age Cholesterol Glucose
##   &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;
## 1  19.3    21         178      95
## 2  24.5    57         250      98
## 3  24.7    46         176     102
## 4  47.9    47         171     105
## 5  44.2    61         222     101
## 6  29.9    74         156      72</code></pre>
</div>
<div id="pruebas-de-supuestos-para-regresión-paramétrica-usando-el-método-de-mínimos-cuadrados-ols-ordinary-least-square" class="section level3">
<h3>Pruebas de supuestos para regresión paramétrica usando el método de mínimos cuadrados (<em>OLS, ordinary least square</em>)</h3>
<ul>
<li><strong>Normalidad</strong>: Gráficamente: Q-Q plot; Estadísticamente: prueba de Shapiro &amp; Wilk (<strong>shapito.test</strong>) o Anderson-Darling (en el paquete <strong>nortest88</strong> y la función <strong>ad_test</strong>).</li>
<li><strong>Independencia</strong>: los valores de <span class="math inline">\(Y_j\)</span> son independientes entre si, lo asumimos (no hay autocorrelación).</li>
<li><strong>Linealidad</strong>: relación lineal entre variable dependiente y cada una de las independientes; gráficas individuales. Puede arreglarse con transformación; prueba de Box Tidwell.</li>
<li><strong>Homocedasticidad</strong>: varianza de la variable dependiente (residuales) no varía con los valores de las variables independientes; gráfica de los residuales.</li>
<li><strong>Multicolinealidad</strong>: las variables independientes no deben estar correlacionadas entre si.</li>
</ul>
<hr />
<div id="normalidad" class="section level4">
<h4>Normalidad</h4>
<ul>
<li>Evaluación gráfica de normalidad de la variable dependiente. Se observa que la mayoría de los datos son muy cerca de la linea, por consecuencia se puede asumir que la variable dependiente tiene una distribución normal.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">ggplot</span>(reg.multiple, <span class="kw">aes</span>(<span class="dt">sample=</span>BMI))<span class="op">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">geom_qq</span>()<span class="op">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/qqplot-1.png" width="672" /></p>
<ul>
<li>Prueba estadística de normalidad Shapiro &amp; Wilk (<span class="math inline">\(H_0:distribución\enspace normal\)</span>) . En este caso tanto la prueba de Shapiro_Wilk (p &gt; 0.07) y la Anderson-Darling (p &gt; 0.12) tiene el mismo resultado, que uno acepta la hipótesis nula, que no hay evidencia que los datos difiere de una distribución normal.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">shapiro.test</span>(reg.multiple<span class="op">$</span>BMI)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  reg.multiple$BMI
## W = 0.96315, p-value = 0.07547</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">library</span>(nortest)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">ad.test</span>(reg.multiple<span class="op">$</span>BMI)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  reg.multiple$BMI
## A = 0.58635, p-value = 0.1209</code></pre>
<hr />
</div>
<div id="autocorrelación" class="section level4">
<h4>Autocorrelación</h4>
<p>La prueba de Durbin-Watson nos permite evaluar si ocurre autocorrelación entre los valores residuales de la variable dependiente. Por ejemplo, una variable que depende del tiempo, presenta autocorrelación. La <span class="math inline">\(H_0\)</span> es que la autocorrelación en los residuales del modelo es 0.</p>
<ul>
<li><p>Prueba de Durbin-Watson para autocorrelación. Pasos</p></li>
<li><p>Construir el modelo</p></li>
<li><p>Aplicar la prueba de autocorrelación sobre el modelo</p></li>
</ul>
<p>La prueba de Durbin-Watson tiene un valor de p &gt; 0.05, por consecuencia no hay evidencia que hay correlación en los datos.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">library</span>(car)</span>
<span id="cb11-2"><a href="#cb11-2"></a>model &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, <span class="dt">data =</span> reg.multiple)</span>
<span id="cb11-3"><a href="#cb11-3"></a>dbt &lt;-<span class="st"> </span><span class="kw">durbinWatsonTest</span>(model, <span class="dt">simulate =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a>dbt</span></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1      0.06609505      1.823275   0.478
##  Alternative hypothesis: rho != 0</code></pre>
<hr />
</div>
<div id="linealidad-del-modelo" class="section level4">
<h4>Linealidad del modelo</h4>
<ul>
<li>Prueba de Box Tidwell para linealidad. Esta prueba es para evaluar si el modelo sigue un patrón lineal. Las estimaciones de máxima de verosimilitud de los parámetros de transformación se calculan mediante el método de Box y Tidwell (1962), que suele ser más eficaz que utilizar una rutina general de mínimos cuadrados no lineal para este problema. La hipótesis nula es que el patrón de relación entre las variables dependientes y indepedientes sean lineal.</li>
</ul>
<p>Se observa que el valor de p &gt;0.05 para cada variable sugiriendo que no hay evidencia que la relación sea diferente de una regresión lineal.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(car)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">boxTidwell</span>(BMI <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, <span class="dt">data =</span> reg.multiple)</span></code></pre></div>
<pre><code>##             MLE of lambda Score Statistic (z) Pr(&gt;|z|)
## Age              -19.8117             -0.8984   0.3690
## Cholesterol       20.2797              0.1879   0.8509
## Glucose           -2.3134              0.1057   0.9158
## 
## iterations =  10</code></pre>
<hr />
</div>
<div id="multicolinealidad" class="section level4">
<h4>Multicolinealidad</h4>
<ul>
<li>Matriz de correlación con la correlaciones de Pearson (asume distribución normal) y gráficas de puntos con líneas de regresión. En este gráfico se observa que el patrón entre cada una de las variables independientes. Con esta se determina si hay alta colinearidad entre las variable.</li>
</ul>
<p>Para dar un ejemplo sencillo si hubiese dos variables que tienen una correlación bien alta entre las dos, las dos variables entonces están incluyendo un componente variación compartido y añadir las dos variables a un modelo de regresión múltiples no seria correcto, porque las dos variables explican la misma variación. En este caso lo que se observa es que BMI y el colesterol tiene una correlación de 28%.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">library</span>(car)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#matriz de correlación</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">cor</span>(reg.multiple)</span></code></pre></div>
<pre><code>##                   BMI       Age Cholesterol    Glucose
## BMI         1.0000000 0.1863333  0.28110580 0.22115998
## Age         0.1863333 1.0000000  0.16966704 0.26705577
## Cholesterol 0.2811058 0.1696670  1.00000000 0.08266412
## Glucose     0.2211600 0.2670558  0.08266412 1.00000000</code></pre>
<p>#gráfica de regresiones en parejas, con línea de regresión</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">scatterplotMatrix</span>(reg.multiple, <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                  <span class="dt">smooth =</span> <span class="kw">list</span>(<span class="dt">lty =</span> <span class="dv">2</span>), <span class="dt">id =</span> <span class="ot">TRUE</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>                  <span class="dt">regLine =</span> <span class="kw">list</span>(<span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb17-4"><a href="#cb17-4"></a>                  <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in applyDefaults(legend, defaults = list(coords = NULL), type =
## &quot;legend&quot;): unnamed legend arguments, will be ignored</code></pre>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="modelos-de-regresión-lineal-múltiple" class="section level3">
<h3>Modelos de regresión lineal múltiple</h3>
<p>A continuación se calculan los parámetros de diversos modelos de regresión, y se incluye una prueba de homocedasticidad (homogeneidad de la varianza) para cada modelo.</p>
<div id="modelo-completo-todas-las-variables" class="section level4">
<h4>Modelo completo (todas las variables)</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>modRM &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, </span>
<span id="cb19-2"><a href="#cb19-2"></a>              <span class="dt">data =</span> reg.multiple)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="kw">summary</span>(modRM)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BMI ~ Age + Cholesterol + Glucose, data = reg.multiple)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.6255  -4.5473  -0.8179   3.7439  18.8116 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 16.81510    5.07180   3.315  0.00164 **
## Age          0.04103    0.05631   0.729  0.46939   
## Cholesterol  0.04819    0.02487   1.938  0.05791 . 
## Glucose      0.01974    0.01493   1.322  0.19188   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.34 on 54 degrees of freedom
## Multiple R-squared:  0.127,  Adjusted R-squared:  0.07855 
## F-statistic:  2.62 on 3 and 54 DF,  p-value: 0.06008</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>aic &lt;-<span class="st"> </span><span class="kw">AIC</span>(modRM)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;AIC = %.2f&quot;</span>, aic)</span></code></pre></div>
<pre><code>## [1] &quot;AIC = 384.68&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># prueba de homocedasticidad (Non-constant Variance Score Test)</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># Ho:la varianza es constante en el ámbito de la predicción de Y</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">ncvTest</span>(modRM)</span></code></pre></div>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 0.02932531, Df = 1, p = 0.86403</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">spreadLevelPlot</span>(modRM)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>## 
## Suggested power transformation:  0.757141</code></pre>
</div>
<div id="modelo-eliminando-la-variable-age-por-ser-la-menos-correlaciona-con-bmi-y-tener-la-mayor-correlación-con-glucose" class="section level4">
<h4>Modelo eliminando la variable Age, por ser la menos correlaciona con BMI, y tener la mayor correlación con Glucose</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>modRM &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, </span>
<span id="cb27-2"><a href="#cb27-2"></a>              <span class="dt">data =</span> reg.multiple)</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw">summary</span>(modRM)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BMI ~ Cholesterol + Glucose, data = reg.multiple)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.125  -4.748  -1.134   3.321  18.832 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 17.95236    4.80502   3.736 0.000446 ***
## Cholesterol  0.05098    0.02447   2.083 0.041902 *  
## Glucose      0.02254    0.01437   1.569 0.122449    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.313 on 55 degrees of freedom
## Multiple R-squared:  0.1185, Adjusted R-squared:  0.08641 
## F-statistic: 3.696 on 2 and 55 DF,  p-value: 0.0312</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>aic &lt;-<span class="st"> </span><span class="kw">AIC</span>(modRM)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;AIC = %.2f&quot;</span>, aic)</span></code></pre></div>
<pre><code>## [1] &quot;AIC = 383.25&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># prueba de homocedasticidad</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">ncvTest</span>(modRM)</span></code></pre></div>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 0.2490362, Df = 1, p = 0.61775</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="kw">spreadLevelPlot</span>(modRM)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>## 
## Suggested power transformation:  1.818741</code></pre>
<hr />
</div>
<div id="modelo-con-interacción-entre-age-y-glucose" class="section level4">
<h4>Modelo con interacción entre Age y Glucose</h4>
<p>Para denotar interacción entre variables se usa el símbolo <strong>( : )</strong> Para incluir las variables solas y su interacción se utiliza el símbolo <strong>( * )</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>modRM &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose<span class="op">:</span>Age, </span>
<span id="cb35-2"><a href="#cb35-2"></a>              <span class="dt">data =</span> reg.multiple)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">summary</span>(modRM)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BMI ~ Cholesterol + Glucose:Age, data = reg.multiple)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5225  -4.6283  -0.8796   3.6945  18.8840 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.879e+01  4.645e+00   4.044 0.000165 ***
## Cholesterol 4.906e-02  2.441e-02   2.010 0.049322 *  
## Glucose:Age 3.662e-04  2.057e-04   1.780 0.080625 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.274 on 55 degrees of freedom
## Multiple R-squared:  0.1292, Adjusted R-squared:  0.09751 
## F-statistic: 4.079 on 2 and 55 DF,  p-value: 0.02229</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>aic &lt;-<span class="st"> </span><span class="kw">AIC</span>(modRM)</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw">sprintf</span>(<span class="st">&quot;AIC = %.2f&quot;</span>, aic)</span></code></pre></div>
<pre><code>## [1] &quot;AIC = 382.54&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># prueba de homocedasticidad</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">ncvTest</span>(modRM)</span></code></pre></div>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 0.07666205, Df = 1, p = 0.78187</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">spreadLevelPlot</span>(modRM)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre><code>## 
## Suggested power transformation:  0.9950719</code></pre>
</div>
</div>
<div id="selección-automática-de-modelo---método-stepwise" class="section level3">
<h3>Selección automática de modelo - método “stepwise”</h3>
<p>Existen métodos para seleccionar automáticamente el mejor modelo, a base de estadísticos indicadores, y que conlleva un procedimiento iterativo. Uno de estos procedimientos es conocido como ‘stepwise’ (por pasos), y aunque no es el más aceptado en la actualidad, ha sido muy usado y es una buena manera de ilustrar el procedimiento, usando nuestros datos.</p>
<p>En este procedimiento el proceso de selección se basa en mantener el modelo con el menor valor del estadístico <strong>AIC</strong> (Akaike Information Criterion), que indica el modelo con la menor pérdida de información y mayor simplicidad. En el proceso se parte de un modelo nulo (no efecto de predictores) y hasta un modelo muy complejo, incluyendo interacciones. Las variables se incluyen y se quitan, y cada vez se recalcula AIC, hasta obtener el modelo que mantiene el mínimo valor de AIC.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">#formulación de un modelo nulo y un modelo completo</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>modNulo &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> reg.multiple)</span>
<span id="cb43-3"><a href="#cb43-3"></a>modFull &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol<span class="op">*</span>Glucose <span class="op">+</span><span class="st"> </span>Age<span class="op">*</span>Cholesterol <span class="op">+</span><span class="st"> </span>Age<span class="op">*</span>Glucose, </span>
<span id="cb43-4"><a href="#cb43-4"></a>              <span class="dt">data =</span> reg.multiple)</span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co">#procedimiento stepwise</span></span>
<span id="cb43-6"><a href="#cb43-6"></a>bmistep &lt;-<span class="st"> </span><span class="kw">step</span>(modNulo,</span>
<span id="cb43-7"><a href="#cb43-7"></a>                <span class="dt">scope =</span> <span class="kw">list</span>(<span class="dt">lower=</span>modNulo, <span class="dt">upper=</span>modFull,</span>
<span id="cb43-8"><a href="#cb43-8"></a>                             <span class="dt">direction=</span><span class="st">&quot;both&quot;</span>))</span></code></pre></div>
<pre><code>## Start:  AIC=219.97
## BMI ~ 1
## 
##               Df Sum of Sq    RSS    AIC
## + Cholesterol  1   196.462 2289.8 217.19
## + Glucose      1   121.605 2364.6 219.06
## + Age          1    86.322 2399.9 219.92
## &lt;none&gt;                     2486.2 219.97
## 
## Step:  AIC=217.19
## BMI ~ Cholesterol
## 
##               Df Sum of Sq    RSS    AIC
## + Glucose      1    98.063 2191.7 216.66
## &lt;none&gt;                     2289.8 217.19
## + Age          1    49.203 2240.6 217.93
## - Cholesterol  1   196.462 2486.2 219.97
## 
## Step:  AIC=216.66
## BMI ~ Cholesterol + Glucose
## 
##                       Df Sum of Sq    RSS    AIC
## &lt;none&gt;                             2191.7 216.66
## + Cholesterol:Glucose  1    55.387 2136.3 217.17
## - Glucose              1    98.063 2289.8 217.19
## + Age                  1    21.337 2170.3 218.09
## - Cholesterol          1   172.920 2364.6 219.06</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">summary</span>(bmistep)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BMI ~ Cholesterol + Glucose, data = reg.multiple)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.125  -4.748  -1.134   3.321  18.832 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 17.95236    4.80502   3.736 0.000446 ***
## Cholesterol  0.05098    0.02447   2.083 0.041902 *  
## Glucose      0.02254    0.01437   1.569 0.122449    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.313 on 55 degrees of freedom
## Multiple R-squared:  0.1185, Adjusted R-squared:  0.08641 
## F-statistic: 3.696 on 2 and 55 DF,  p-value: 0.0312</code></pre>
<hr />
</div>
<div id="comparación-de-modelos" class="section level3">
<h3>Comparación de modelos</h3>
<div id="gráfica-de-coeficientes" class="section level4">
<h4>Gráfica de coeficientes</h4>
<p>Una manera de comparar visualmente modelos (en realidad sus coeficientes) es usar el paquete <strong>coefplot</strong>, en conjunto con <strong>ggplot2</strong>, para crear una gráfica de los coeficientes estimados de cada variable (sola o de interacción), en cada modelo y detectar los que son diferentes de 0, y los modelos que los contienen.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="kw">library</span>(coefplot)</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="co">#cálculo para todos los modelos</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>modbmi1 &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, <span class="dt">data=</span>reg.multiple)</span>
<span id="cb47-5"><a href="#cb47-5"></a>modbmi2 &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Age<span class="op">*</span>Glucose <span class="op">+</span><span class="st"> </span>Cholesterol<span class="op">*</span>Glucose <span class="op">+</span><span class="st"> </span>Age<span class="op">*</span>Cholesterol, <span class="dt">data=</span>reg.multiple)</span>
<span id="cb47-6"><a href="#cb47-6"></a>modbmi3 &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Age<span class="op">:</span>Glucose, <span class="dt">data=</span>reg.multiple)</span>
<span id="cb47-7"><a href="#cb47-7"></a>modbmi4 &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol <span class="op">+</span><span class="st"> </span>Glucose, <span class="dt">data=</span>reg.multiple)</span>
<span id="cb47-8"><a href="#cb47-8"></a>modbmi5 &lt;-<span class="st"> </span><span class="kw">lm</span>(BMI <span class="op">~</span><span class="st"> </span>Cholesterol, <span class="dt">data =</span> reg.multiple)</span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="co">#comparando coeficientes de todos los modelos</span></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="kw">multiplot</span>(modbmi1, modbmi2, modbmi3, modbmi4, modbmi5, <span class="dt">pointSize =</span> <span class="dv">2</span>, <span class="dt">intercept=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<hr />
</div>
<div id="selección-de-modelo-usando-r-cuadrado-ajustado-y-mallows-cp-para-mejores-modelos" class="section level4">
<h4>Selección de modelo usando R-cuadrado ajustado y Mallow’s Cp para mejores modelos</h4>
<p>El estadístico <span class="math inline">\(R^2\)</span> es la cantidad de varianza en la respuesta (variable dependiente) producido por las variables predictoras, mediante el modelo, por lo tanto constituye una buena manera de medir la capacidad del modelo para “explicar” los datos. Sin embargo, en un modelo de regresión múltiple, el <span class="math inline">\(R^2\)</span> aumenta al aumentar el número de predictores, lo cual conlleva a sobrestimar la “calidad” del modelo, con un número excesivo de variables. Usando el <span class="math inline">\(R^2ajustado\)</span> se toma en cuenta el número de parámetros en el modelo, por lo tanto es una medida más realista del ajuste al modelo.</p>
<p>El estadístico de Mallow, <span class="math inline">\(C_p\)</span>, es otro indicador para seleccionar el mejor modelo en una regresión múltiple; funciona de manera similar al AIC, y sirve para evitar incluir parámetros en exceso en el modelo. La regla general es escoger el modelo con el número de parámetros, en el cual el valor de <span class="math inline">\(C_p\)</span> sea cercano (pero menor) al número de parámetros más 1.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">library</span>(leaps)</span>
<span id="cb48-2"><a href="#cb48-2"></a>modSS &lt;-<span class="st"> </span><span class="kw">regsubsets</span>(BMI <span class="op">~</span><span class="st"> </span>Age<span class="op">*</span>Cholesterol <span class="op">+</span><span class="st"> </span>Cholesterol<span class="op">*</span>Glucose <span class="op">+</span><span class="st"> </span>Age<span class="op">*</span>Glucose, <span class="dt">data =</span> reg.multiple, <span class="dt">nbest =</span> <span class="dv">3</span>, <span class="dt">intercept =</span> <span class="ot">TRUE</span>)</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co"># gráfica para R^2 ajustado</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="kw">plot</span>(modSS, <span class="dt">scale=</span><span class="st">&quot;adjr2&quot;</span>)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># gráfica para Cp</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="kw">plot</span>(modSS, <span class="dt">scale=</span><span class="st">&quot;Cp&quot;</span>)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># otra forma de visualizar Cp</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="kw">library</span>(car)</span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="co">## Mallow Cp</span></span>
<span id="cb50-4"><a href="#cb50-4"></a>mallowCp &lt;-</span>
<span id="cb50-5"><a href="#cb50-5"></a><span class="st">    </span><span class="kw">subsets</span>(modSS, <span class="dt">statistic=</span><span class="st">&quot;cp&quot;</span>, <span class="dt">legend =</span> <span class="ot">FALSE</span>, <span class="dt">min.size =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Mallow Cp&quot;</span>)</span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="TF3_Regresion_Multiples_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<hr />
</div>
</div>
<div id="ejercicio" class="section level3">
<h3>EJERCICIO</h3>
<ol style="list-style-type: decimal">
<li>Usar los datos <a href="https://drive.google.com/open?id=1Q5rkNpatiTDg90ieVbwAw_fziIQNA4eJ">deathsmall_cities.xlsx</a> para buscar un modelo de regresión múltiple entre la variable dependiente <em>death1K</em> (muertes anuales por cada 1000 habitantes) y las otras variables del archivo.</li>
</ol>
<p><img src="Graficos/UPR_Logos.png" width="100%" /></p>
<hr />
<blockquote>
<p>“Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</blockquote>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
