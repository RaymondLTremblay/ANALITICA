<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regresion Poisson</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="tutorial.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ANALITICA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Estadística básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="E1-Introducción.html">¿Qué es la Estadística?</a>
    </li>
    <li>
      <a href="E2-Historia.html">Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="E3-TallerRFE_I.html">Introducción a R, Rstudio y RMarkdown</a>
    </li>
    <li>
      <a href="E4-Graficos.html">Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="E5-supuestos.html">Los Supuestos de las pruebas paramétricas</a>
    </li>
    <li>
      <a href="E6-TallerRFE_II.html">Regresión simple y ANOVA</a>
    </li>
    <li>
      <a href="E7-TRAvanzado.html">Modelos Lineales</a>
    </li>
    <li>
      <a href="E8-Tipos_de_Datos.html">Tipos de Datos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Visualización
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="G1-ggplot2.html">Qué es la visualización de datos y ejemplos historicos</a>
    </li>
    <li>
      <a href="G2-Errores-tipicos-en-la-visualizacion.html">Errores típicos en la visualización</a>
    </li>
    <li>
      <a href="G3-Graficos-por-conteos.html">Gráficos para conteos</a>
    </li>
    <li>
      <a href="G4-Grafico-de-puntos-de-Wilkinson.html">Gráficos de puntos de Wilkinson</a>
    </li>
    <li>
      <a href="G5_geom_area_densidad_freqpoly.html">Gráficos de area y densidad</a>
    </li>
    <li>
      <a href="G6_geom_histogram.html">Histogramas</a>
    </li>
    <li>
      <a href="G7_geom_bar.html">Gráficos de barras</a>
    </li>
    <li>
      <a href="G8_geom_boxplot_geom_violin.html">Gráficos de caja y de violín</a>
    </li>
    <li>
      <a href="G9_Facet_Grid.html">Facet Grid</a>
    </li>
    <li>
      <a href="G10_Facet_wrap.html">Facet Wrap</a>
    </li>
    <li>
      <a href="G11_EVALUANDO_SUPUESTOS.html">Evaluando Supuestos</a>
    </li>
    <li>
      <a href="G12_Mapas_Calor.html">Mapas de Calor</a>
    </li>
    <li>
      <a href="G13_geom_line.html">Gráficos con lineas</a>
    </li>
    <li>
      <a href="G14_geom_point_geom_jitter.html">Geom_point y geom_jitter</a>
    </li>
    <li>
      <a href="G15_gganimate.html">Gráficos animados en movimiento</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sreencasts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="screencast_t_test.html">t-test Screencast</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Lo básico de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Lo básico de RMarkdown</a>
    </li>
    <li>
      <a href="Tendencias_Centrales.html"> Tendencias Centrales</a>
    </li>
    <li>
      <a href="Medidas_Dispersión.html"> Medidas de Dispersión</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Taller para Facultad
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TF_1_Descripción.html">Descripción del taller</a>
    </li>
    <li>
      <a href="TF1_Regresion_Lineal.html">Regresion_Lineal</a>
    </li>
    <li>
      <a href="TF2_Regresion_Cuadratica_otro.html">Regresion no lineal</a>
    </li>
    <li>
      <a href="TF3_Regresion_Multiples.html">Regresion Multiples</a>
    </li>
    <li>
      <a href="TF4_GLM.html">Modelos Lineales Generalizados</a>
    </li>
    <li>
      <a href="TF5_Regresion_logistica.html">Regresion Logística</a>
    </li>
    <li>
      <a href="TF6_Regresion_Poisson.html">Regresion Poisson</a>
    </li>
    <li>
      <a href="TF7_Regresion_beta.html">Regresion Beta</a>
    </li>
    <li>
      <a href="TF8_Akaike_Information_Criterion.html">Criterio de Selección</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Datos.html">Los Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Regresion Poisson</h1>

</div>


<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #437d66;
}
</style>
<p><img src="Graficos/Analitica.png" width="50%" /><img src="Graficos/UPR_IPERT_logo.png" width="50%" /></p>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(arm)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(coefplot)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<hr />
<div id="regresión-poisson" class="section level2">
<h2>Regresión Poisson</h2>
<p>La regresión Poisson es parte de los modelos lineales generalizados (GLM) y se utiliza cuando la variable de respuesta son conteos, unidas discretas positiva.</p>
<p>Los datos provienen del libro y ejemplos de Jared Lander, R for Everyone, 2nd Edition, Addison Wesley Data &amp; Analitics Series, 2017.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>acs=<span class="kw">read.table</span>(<span class="st">&quot;https://jaredlander.com/data/acs_ny.csv&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">library</span>(readr)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#acs_ny &lt;- read_csv(&quot;acs_ny.csv&quot;)</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#acs=acs_ny</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">head</span>(acs)</span></code></pre></div>
<pre><code>##   Acres FamilyIncome  FamilyType NumBedrooms NumChildren NumPeople NumRooms
## 1  1-10          150     Married           4           1         3        9
## 2  1-10          180 Female Head           3           2         4        6
## 3  1-10          280 Female Head           4           0         2        8
## 4  1-10          330 Female Head           2           1         2        4
## 5  1-10          330   Male Head           3           1         2        5
## 6  1-10          480   Male Head           0           3         4        1
##          NumUnits NumVehicles NumWorkers  OwnRent   YearBuilt HouseCosts
## 1 Single detached           1          0 Mortgage   1950-1959       1800
## 2 Single detached           2          0   Rented Before 1939        850
## 3 Single detached           3          1 Mortgage   2000-2004       2600
## 4 Single detached           1          0   Rented   1950-1959       1800
## 5 Single attached           1          0 Mortgage Before 1939        860
## 6 Single detached           0          0   Rented Before 1939        700
##   ElectricBill FoodStamp HeatingFuel Insurance       Language
## 1           90        No         Gas      2500        English
## 2           90        No         Oil         0        English
## 3          260        No         Oil      6600 Other European
## 4          140        No         Oil         0        English
## 5          150        No         Gas       660        Spanish
## 6          140        No         Gas         0        English</code></pre>
<hr />
</div>
<div id="qué-es-una-distribución-poisson" class="section level2">
<h2>Qué es una distribución Poisson</h2>
<p>La distribución de Poisson se usa cuando tenemos valores numéricos discretos, 0, 1, 2, 3, 4…k, pero no puede tener valores parciales como 1.4</p>
<p>La formulación de la regresión de Poisson es <span class="math inline">\({ y }_{ i }~ pois({ \theta }_{ i })\)</span> donde <span class="math inline">\({ y }_{ i }\)</span> es la i-ésima respuesta y <span class="math inline">\({ \theta }_{ i }=\quad { e }^{ { X }_{ i }\beta}\)</span> es la media de la distribución para la i-ésima observación.</p>
<p>Para el primer ejercicio nota aquí que los datos es la cantidad de hijos por familia. El primer punto que hay que apreciar es que los valores son unidades, y que estos no puede haber 1.1, medio hijo o -1 hijo. En otra palabra es que los datos están en intervalos y positivo. Entonces la distribución Poisson es una variable <strong>x</strong> de datos al azar y discreta y tiene una distribución Poisson si los parámetros <span class="math inline">\(\lambda\)</span> &gt; 0, para k = 0,1,2,….k, y la función de probabilidad es igual a</p>
<p><span class="math display">\[Pr\left(x=k\right)=\frac{\lambda^k\cdot e^{-\lambda}}{k!}\]</span></p>
<p>donde</p>
<ul>
<li>e es igual al valor de Euler, e=2.71828…</li>
<li>k es el número de ocurrencias.</li>
<li>k! es el factorial de k.</li>
</ul>
<p>Cuando se describe una distribución Poisson el promedio es <span class="math inline">\(\lambda\)</span> y la varianza es tambien <span class="math inline">\(\lambda\)</span>. Es el mismo valor. Para la descripción de los otras medidas de tendencia centrales y de dispersión vea el website de Wikipedia (<a href="https://en.wikipedia.org/wiki/Poisson_distribution" class="uri">https://en.wikipedia.org/wiki/Poisson_distribution</a>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">23454</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>foo &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>        <span class="dt">df1 =</span> <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="st">&#39;lambda_1&#39;</span>, <span class="dv">500</span>), <span class="dt">y =</span> <span class="kw">rpois</span>(<span class="dv">500</span>, <span class="dv">1</span>)), </span>
<span id="cb4-4"><a href="#cb4-4"></a>        <span class="dt">df5 =</span> <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="st">&#39;lambda_5&#39;</span>, <span class="dv">500</span>), <span class="dt">y =</span> <span class="kw">rpois</span>(<span class="dv">500</span>, <span class="dv">5</span>)),</span>
<span id="cb4-5"><a href="#cb4-5"></a>        <span class="dt">df15 =</span> <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="st">&#39;lambda_15&#39;</span>, <span class="dv">500</span>), <span class="dt">y =</span> <span class="kw">rpois</span>(<span class="dv">500</span>, <span class="dv">15</span>)),</span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="dt">df25 =</span> <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">rep</span>(<span class="st">&#39;lambda_50&#39;</span>, <span class="dv">500</span>), <span class="dt">y =</span> <span class="kw">rpois</span>(<span class="dv">500</span>, <span class="dv">50</span>))</span>
<span id="cb4-7"><a href="#cb4-7"></a>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#foo</span></span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a>lambda=<span class="kw">rbind</span>(foo<span class="op">$</span>df1, foo<span class="op">$</span>df5,foo<span class="op">$</span>df15,foo<span class="op">$</span>df25 )</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">head</span>(lambda)</span></code></pre></div>
<pre><code>##          x y
## 1 lambda_1 1
## 2 lambda_1 1
## 3 lambda_1 1
## 4 lambda_1 0
## 5 lambda_1 3
## 6 lambda_1 1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>lambda<span class="op">$</span>x =<span class="st"> </span><span class="kw">factor</span>(lambda<span class="op">$</span>x, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&#39;lambda_1&#39;</span>,<span class="st">&#39;lambda_5&#39;</span>,<span class="st">&#39;lambda_15&#39;</span>,<span class="st">&#39;lambda_50&#39;</span>))</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">head</span>(lambda)</span></code></pre></div>
<pre><code>##          x y
## 1 lambda_1 1
## 2 lambda_1 1
## 3 lambda_1 1
## 4 lambda_1 0
## 5 lambda_1 3
## 6 lambda_1 1</code></pre>
<hr />
<div id="distribución-de-frecuencia-de-distribución-poisson" class="section level3">
<h3>Distribución de frecuencia de distribución Poisson</h3>
<p>Las figuras de la frecuencia demuestra , nota que se tiene 500 valores seleccionado al azar en cada simulación donde el promedio, <span class="math inline">\(\lambda\)</span> varia, los <span class="math inline">\(\lambda\)</span> son 1, 5, 15 y 25. Nota que un <span class="math inline">\(\lambda\)</span> de uno es que tiene un promedio de uno y una varianza de 1. A medida que el promedio se aleja de 0 y que la muestra es grande la distribución se acerca a una distribución normal.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">ggplot</span>(lambda, <span class="kw">aes</span>(y, <span class="dt">fill=</span>x))<span class="op">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">geom_histogram</span>(<span class="dt">color=</span><span class="st">&quot;#e9ecef&quot;</span>)<span class="op">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>x, <span class="dt">scales=</span><span class="st">&quot;free_y&quot;</span>)<span class="op">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frecuencia&quot;</span>)<span class="op">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;k&quot;</span>)</span></code></pre></div>
<p><img src="TF6_Regresion_Poisson_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<hr />
</div>
<div id="función-de-probabilidad" class="section level3">
<h3>Función de Probabilidad</h3>
<p>Se puede convertir estos gráfico en “probability mass distribution”. En esta ocasión la distribución sigue la siguiente ecuación,</p>
<p><span class="math display">\[Pr\left(x=k\right)=\frac{\lambda^k\cdot e^{-\lambda}}{k!}\]</span></p>
<p>La suma de <span class="math inline">\(Pr\left(x=k\right)\)</span> es igual a uno.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">ggplot</span>(lambda, <span class="kw">aes</span>(y, <span class="dt">fill=</span>x))<span class="op">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">color=</span><span class="st">&quot;#e9ecef&quot;</span>)<span class="op">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>x)<span class="op">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;P(X=k)&quot;</span>)<span class="op">+</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;k&quot;</span>)</span></code></pre></div>
<p><img src="TF6_Regresion_Poisson_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="probabilidades-cumulativas" class="section level2">
<h2>Probabilidades cumulativas</h2>
<p>Aqui se aplica la función para visualizar la probabilidades cumulativas, vea <strong>stat_ecdf {ggplot2}</strong> para más detalles. Lo que se observa es la probabilidad de incluir los valores cumulativamente. Los más importante es reconocer que la adición de las probabilidades no es continua, pero “salta” de un valor a otra a medida que se añade la frecuencia de los valores en el eje de x. Si fuese una distribución normal, la linea seria suavizada. Nota que cuando el valor de <span class="math inline">\(\lambda\)</span> es más grande los saltos son más pequeños (es más suave el cambio).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">ggplot</span>(lambda, <span class="kw">aes</span>(y, <span class="dt">colour=</span>x))<span class="op">+</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;step&quot;</span>)<span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;P(X=k)&quot;</span>)<span class="op">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;k&quot;</span>)</span></code></pre></div>
<p><img src="TF6_Regresion_Poisson_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<hr />
</div>
<div id="ejemplos-de-datos-poisson" class="section level2">
<h2>Ejemplos de Datos Poisson</h2>
<p>Muchas veces los datos que uno recolecta tienen esta características de ser discreto y positivos. En este ejemplo es el número de hijos que tiene familias. Los datos son discretos y positivos.</p>
<p>Ejemplos:</p>
<ul>
<li>El número de hijos por mujer.</li>
<li>El número de errores ortográficos en una frase de 100 palabras</li>
<li>El número de animales muertos en la carretera por una distancia especifica</li>
<li>El número de mutaciones en una cadena de ADN</li>
<li>El número de estudiantes por salón</li>
<li>El número de frutos por planta</li>
</ul>
<hr />
</div>
<div id="regresión-poisson-1" class="section level2">
<h2>Regresión Poisson</h2>
<p>El primer paso es evaluar la variable de dependiente. Miramos las variables del archivo.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">head</span>(acs)</span></code></pre></div>
<pre><code>##   Acres FamilyIncome  FamilyType NumBedrooms NumChildren NumPeople NumRooms
## 1  1-10          150     Married           4           1         3        9
## 2  1-10          180 Female Head           3           2         4        6
## 3  1-10          280 Female Head           4           0         2        8
## 4  1-10          330 Female Head           2           1         2        4
## 5  1-10          330   Male Head           3           1         2        5
## 6  1-10          480   Male Head           0           3         4        1
##          NumUnits NumVehicles NumWorkers  OwnRent   YearBuilt HouseCosts
## 1 Single detached           1          0 Mortgage   1950-1959       1800
## 2 Single detached           2          0   Rented Before 1939        850
## 3 Single detached           3          1 Mortgage   2000-2004       2600
## 4 Single detached           1          0   Rented   1950-1959       1800
## 5 Single attached           1          0 Mortgage Before 1939        860
## 6 Single detached           0          0   Rented Before 1939        700
##   ElectricBill FoodStamp HeatingFuel Insurance       Language
## 1           90        No         Gas      2500        English
## 2           90        No         Oil         0        English
## 3          260        No         Oil      6600 Other European
## 4          140        No         Oil         0        English
## 5          150        No         Gas       660        Spanish
## 6          140        No         Gas         0        English</code></pre>
<p>La variable dependiente en nuestro análisis es número de hijos <strong>NumChildren</strong>. Se observa que la mayoria de las familias no tienen hijos,</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">ggplot</span>(acs, <span class="kw">aes</span>(<span class="dt">x=</span>NumChildren))<span class="op">+</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bindwidth=</span><span class="dv">1</span>, <span class="dt">fill=</span><span class="st">&quot;#376889&quot;</span>)<span class="op">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">round</span>(<span class="kw">seq</span>(<span class="kw">min</span>(acs<span class="op">$</span>NumChildren), <span class="kw">max</span>(acs<span class="op">$</span>NumChildren), <span class="dt">by =</span> <span class="dv">1</span>),<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: bindwidth</code></pre>
<p><img src="TF6_Regresion_Poisson_files/figure-html/PR-1.png" width="672" /></p>
</div>
<div id="modelo-poisson" class="section level2">
<h2>Modelo Poisson</h2>
<p>El modelo de regresión Poisson usa la función <strong>glm()</strong> y una transformación <strong>log</strong> con la siguiente función <strong>family=poisson(link=“log”)</strong>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>children1&lt;-<span class="kw">glm</span>(NumChildren<span class="op">~</span>FamilyIncome<span class="op">+</span>FamilyType<span class="op">+</span>OwnRent,</span>
<span id="cb15-2"><a href="#cb15-2"></a>               <span class="dt">data=</span>acs, <span class="dt">family=</span><span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>))</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">summary</span>(children1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = NumChildren ~ FamilyIncome + FamilyType + OwnRent, 
##     family = poisson(link = &quot;log&quot;), data = acs)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9950  -1.3235  -1.2045   0.9464   6.3781  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -3.257e-01  2.103e-02 -15.491  &lt; 2e-16 ***
## FamilyIncome         5.420e-07  6.572e-08   8.247  &lt; 2e-16 ***
## FamilyTypeMale Head -6.298e-02  3.847e-02  -1.637    0.102    
## FamilyTypeMarried    1.440e-01  2.147e-02   6.707 1.98e-11 ***
## OwnRentOutright     -1.974e+00  2.292e-01  -8.611  &lt; 2e-16 ***
## OwnRentRented        4.086e-01  2.067e-02  19.773  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 35240  on 22744  degrees of freedom
## Residual deviance: 34643  on 22739  degrees of freedom
## AIC: 61370
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">coefplot</span>(children1)</span></code></pre></div>
<p><img src="TF6_Regresion_Poisson_files/figure-html/PR2-1.png" width="672" /></p>
</div>
<div id="qué-es-la-sobre-dispersión" class="section level2">
<h2>¿Qué es la sobre dispersión?</h2>
<p>En estadística, la sobredispersión es la presencia de una mayor variabilidad (dispersión estadística) en un conjunto de datos de lo que se esperaría según un modelo estadístico dado. En el modelo Poisson, el promedio es igual a <span class="math inline">\(\lambda\)</span> y la varianza es igual a <span class="math inline">\(\lambda\)</span>, entonces son iguales. Por consecuencia el supuesto es que la hipótesis nula es que la varianza es igual a</p>
<p>La sobre es definida como</p>
<p><span class="math display">\[OD=\frac { 1 }{ n-p } \sum _{ i=1 }^{ n }{ { z }_{ i }^{ 2 } }\]</span></p>
<p>donde</p>
<p><span class="math display">\[{ z }_{ i }=\frac { \gamma _{ i }-{ \hat { \gamma } }_{ i } }{ sd({ \hat { \gamma } }_{ i }) } =\frac { \gamma _{ i }-{ \mu }_{ i }{ \hat { \theta } }_{ i } }{ \sqrt { { \mu }_{ i }{ \hat { \theta } }_{ i } } }\]</span></p>
<p>Se puede evaluar los residuales estandarizados en R con el siguiente script. El modelo se llama <strong>children1</strong> y se aplica la formula arriba de la siguiente forma.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>z&lt;-(acs<span class="op">$</span>NumChildren<span class="op">-</span>children1<span class="op">$</span>fitted.values)<span class="op">/</span><span class="kw">sqrt</span>(children1<span class="op">$</span>fitted.values)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">head</span>(z)</span></code></pre></div>
<pre><code>##           1           2           3           4           5           6 
##  0.18186518  0.87627176 -0.84977889 -0.08314153  0.39096022  1.95966583</code></pre>
<div id="el-factor-de-sobredispersión" class="section level3">
<h3>El factor de sobredispersión</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">sum</span>(z<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>children1<span class="op">$</span>df.residual</span></code></pre></div>
<pre><code>## [1] 1.469747</code></pre>
</div>
</div>
<div id="probando-si-hay-sobredisperión" class="section level2">
<h2>Probando si hay sobredisperión</h2>
<p>Generalmente, una relación de sobredispersión de 2 o más indica sobredispersión. Si bien esta relación de sobredispersión es menor que 2, el valor p es 1, lo que significa que hay una sobredispersión estadísticamente significativa. Así que reajustamos el modelo para tener en cuenta la sobredispersión usando la familia de quasipoisson, que en realidad usa la distribución binomial negativa.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">library</span>(AER)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw">dispersiontest</span>(children1, <span class="dt">trafo=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  children1
## z = 27.518, p-value &lt; 2.2e-16
## alternative hypothesis: true alpha is greater than 0
## sample estimates:
##     alpha 
## 0.4696118</code></pre>
<p>Pueden encontrar otras alternativas de como evaluar si hay sobredispersión de los datos en este enlace. <a href="https://stats.stackexchange.com/questions/66586/is-there-a-test-to-determine-whether-glm-overdispersion-is-significant" class="uri">https://stats.stackexchange.com/questions/66586/is-there-a-test-to-determine-whether-glm-overdispersion-is-significant</a></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>children2&lt;-<span class="kw">glm</span>(NumChildren<span class="op">~</span>FamilyIncome<span class="op">+</span>FamilyType<span class="op">+</span>OwnRent,</span>
<span id="cb24-2"><a href="#cb24-2"></a>               <span class="dt">data=</span>acs, <span class="dt">family=</span><span class="kw">quasipoisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>))</span>
<span id="cb24-3"><a href="#cb24-3"></a></span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># Me will now compare the dispersion pattern visually for both models.  </span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="kw">multiplot</span>(children1, children2)</span></code></pre></div>
<p><img src="TF6_Regresion_Poisson_files/figure-html/PR6-1.png" width="672" /></p>
<blockquote>
<p>“Activities reported in this website was supported by the National Institute of General Medical Sciences of the National Institutes of Health under Award Number R25GM121270. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.”</p>
</blockquote>
<p><img src="Graficos/UPR_Logos.png" width="100%" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
